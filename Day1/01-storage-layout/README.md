# 1. EVM Storage Layout ë§ˆìŠ¤í„°

## ğŸ“š í•™ìŠµ ëª©í‘œ

- EVMì˜ 32ë°”ì´íŠ¸ ìŠ¬ë¡¯ êµ¬ì¡°ë¥¼ ì™„ë²½íˆ ì´í•´í•œë‹¤
- ë³€ìˆ˜ íŒ¨í‚¹(Variable Packing) ì›ë¦¬ë¥¼ ì†ìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤
- ë™ì  ë°°ì—´ê³¼ ë§¤í•‘ì˜ ìŠ¬ë¡¯ ê³„ì‚°ë²•ì„ ë§ˆìŠ¤í„°í•œë‹¤

---

## âš¡ ë¹ ë¥¸ ì‹œì‘ (5ë¶„)

ì²˜ìŒ ì‹œì‘í•˜ëŠ” ë¶„ë“¤ì„ ìœ„í•œ ë¹ ë¥¸ ê°€ì´ë“œ:

```bash
# 1. step01_practice í´ë”ë¡œ ì´ë™
cd Day1/01-storage-layout/step01_practice

# 2. ì»´íŒŒì¼
forge build

# 3. Storage Layout í™•ì¸ (ê°€ì¥ ì¤‘ìš”!)
forge inspect StorageLayout storageLayout

# 4. í…ŒìŠ¤íŠ¸ ì‹¤í–‰
forge test -vv
```

ì´ ëª…ë ¹ì–´ë“¤ì„ ì‹¤í–‰í•˜ë©´ Storage Layoutì´ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

---

## ğŸ—ºï¸ ì „ì²´ í•™ìŠµ ê°€ì´ë“œ

### ğŸ“ í´ë” êµ¬ì¡°

```
01-storage-layout/
â”œâ”€â”€ README.md              # ì´ íŒŒì¼ (ì „ì²´ í•™ìŠµ ê°€ì´ë“œ)
â”œâ”€â”€ step01_practice/              # ì‹¤ìŠµìš© ì½”ë“œ (ì˜ˆì œì™€ í•¨ê»˜ ë”°ë¼í•˜ê¸°)
â”‚   â”œâ”€â”€ StorageLayout.sol  # ì‹¤ìŠµ ì»¨íŠ¸ë™íŠ¸ (ì™„ì„±ëœ ì˜ˆì œ ì½”ë“œ)
â”‚   â”œâ”€â”€ StorageLayout.t.sol # í…ŒìŠ¤íŠ¸ íŒŒì¼ (ì™„ì„±ëœ ì˜ˆì œ ì½”ë“œ)
â”‚   â””â”€â”€ foundry.toml       # Foundry ì„¤ì •
â””â”€â”€ step02_exercises/             # ì—°ìŠµë¬¸ì œ (ì§ì ‘ í’€ì–´ë³´ê¸°)
    â”œâ”€â”€ EXERCISES.md       # ë¬¸ì œ ì„¤ëª… ë° ê³¼ì œ
    â””â”€â”€ StorageLayout.sol  # ë¬¸ì œìš© ë¹ˆ ì»¨íŠ¸ë™íŠ¸ (ì§ì ‘ ì‘ì„±í•´ì•¼ í•¨)
```

### ğŸ“š í´ë”ë³„ ì—­í•  ì„¤ëª…

#### **step01_practice/ í´ë”: ì˜ˆì œ ì½”ë“œ ë”°ë¼í•˜ê¸°**
- **ëª©ì **: ì´ë¡ ì„ ì‹¤ì œ ì½”ë“œë¡œ í™•ì¸í•˜ë©° í•™ìŠµ
- **íŠ¹ì§•**: 
  - âœ… ì™„ì„±ëœ ì˜ˆì œ ì½”ë“œê°€ ì œê³µë¨
  - âœ… í…ŒìŠ¤íŠ¸ ì½”ë“œë„ ì™„ì„±ë˜ì–´ ìˆìŒ
  - âœ… `forge test`ë¡œ ë°”ë¡œ ì‹¤í–‰ ê°€ëŠ¥
  - âœ… `forge inspect`ë¡œ Storage Layout í™•ì¸ ê°€ëŠ¥
- **í•™ìŠµ ë°©ì‹**: ì½”ë“œë¥¼ ì½ê³ , ì‹¤í–‰í•˜ê³ , ê²°ê³¼ë¥¼ ê´€ì°°í•˜ë©° ì´í•´

#### **step02_exercises/ í´ë”: ì§ì ‘ ë¬¸ì œ í’€ê¸°**
- **ëª©ì **: ë°°ìš´ ë‚´ìš©ì„ ì§ì ‘ ì ìš©í•˜ì—¬ ì‹¤ë ¥ í–¥ìƒ
- **íŠ¹ì§•**:
  - âŒ ì™„ì„±ëœ ì½”ë“œ ì—†ìŒ (ì§ì ‘ ì‘ì„±í•´ì•¼ í•¨)
  - âŒ í…ŒìŠ¤íŠ¸ ì½”ë“œë„ ì§ì ‘ ì‘ì„±í•´ì•¼ í•¨
  - âœ… `EXERCISES.md`ì— ë¬¸ì œ ì„¤ëª…ê³¼ íŒíŠ¸ ì œê³µ
  - âœ… 5ê°œì˜ ë¬¸ì œê°€ ë‹¨ê³„ë³„ë¡œ ì œê³µë¨
- **í•™ìŠµ ë°©ì‹**: 
  1. ë¬¸ì œë¥¼ ì½ê³  ì´í•´
  2. ì†ìœ¼ë¡œ ê³„ì‚°
  3. ì½”ë“œë¡œ êµ¬í˜„
  4. `forge inspect`ë¡œ ê²€ì¦
  5. ì •ë‹µê³¼ ë¹„êµ

**ì°¨ì´ì  ìš”ì•½:**
| í•­ëª© | step01_practice/ | step02_exercises/ |
|------|-----------|------------|
| **ì½”ë“œ ìƒíƒœ** | ì™„ì„±ë¨ âœ… | ë¹„ì–´ìˆìŒ (ì§ì ‘ ì‘ì„±) âŒ |
| **í•™ìŠµ ë°©ì‹** | ë”°ë¼í•˜ê¸° | ì§ì ‘ í’€ê¸° |
| **ë‚œì´ë„** | ì‰¬ì›€ (ì˜ˆì œ) | ì¤‘ê°„ (ì‹¤ì „) |
| **ëª©ì ** | ê°œë… ì´í•´ | ì‹¤ë ¥ í–¥ìƒ |

### ğŸ¯ í•™ìŠµ ìˆœì„œ (ê¶Œì¥)

#### **1ë‹¨ê³„: ì´ë¡  í•™ìŠµ** (30ë¶„)
1. **EVM Storage ê¸°ë³¸ êµ¬ì¡°** ì½ê¸°
2. **ë³€ìˆ˜ íŒ¨í‚¹** ê°œë… ì´í•´
3. **ë™ì  ë°°ì—´ê³¼ ë§¤í•‘** ì›ë¦¬ íŒŒì•…
4. **keccak256** í•´ì‹œ í•¨ìˆ˜ ì´í•´

---

## ğŸ“ ì´ë¡  í•™ìŠµ

### EVM Storage ê¸°ë³¸ êµ¬ì¡°

EVMì˜ ìŠ¤í† ë¦¬ì§€ëŠ” **2^256ê°œì˜ ìŠ¬ë¡¯**ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ê° ìŠ¬ë¡¯ì€ **32ë°”ì´íŠ¸(256ë¹„íŠ¸)**, í•œ ë©ì–´ë¦¬(word)ì…ë‹ˆë‹¤.

```
Slot 0: [32 bytes]
Slot 1: [32 bytes]
Slot 2: [32 bytes]
...
Slot 2^256-1: [32 bytes]
```

### ë³€ìˆ˜ íŒ¨í‚¹ (Variable Packing)

SolidityëŠ” **ê°™ì€ ìŠ¬ë¡¯ì— ì—¬ëŸ¬ ë³€ìˆ˜ë¥¼ ì €ì¥**í•˜ì—¬ ê°€ìŠ¤ë¥¼ ì ˆì•½í•©ë‹ˆë‹¤.

#### ê·œì¹™:
1. ê° ë³€ìˆ˜ëŠ” ì„ ì–¸ ìˆœì„œëŒ€ë¡œ ì €ì¥ë©ë‹ˆë‹¤
2. **ê°™ì€ ìŠ¬ë¡¯ì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” ê²½ìš°**ì—ë§Œ íŒ¨í‚¹ë©ë‹ˆë‹¤
3. ë‹¤ìŒ ìŠ¬ë¡¯ìœ¼ë¡œ ë„˜ì–´ê°€ëŠ” ì¡°ê±´:
   - í˜„ì¬ ìŠ¬ë¡¯ì˜ ë‚¨ì€ ê³µê°„ì´ ë¶€ì¡±í•  ë•Œ
   - ë‹¤ìŒ ë³€ìˆ˜ê°€ 32ë°”ì´íŠ¸ë³´ë‹¤ í´ ë•Œ

uint256, bytes32 ê°™ì€ 32ë°”ì´íŠ¸ íƒ€ì…ì€ ë³´í†µ ìŠ¬ë¡¯ 1ê°œë¥¼ í†µì§¸ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
uint8, bool, address(20B)ì²˜ëŸ¼ 32ë°”ì´íŠ¸ë³´ë‹¤ ì‘ì€ ê°’ë“¤ì€ ê°™ì€ ìŠ¬ë¡¯ì— ì°¨ê³¡ì°¨ê³¡ packing(ë¼ì›Œë„£ê¸°)ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ì˜ˆì œ 1: ê¸°ë³¸ íŒ¨í‚¹

```solidity
contract PackingExample {
    uint128 a;  // Slot 0 (0-15 bytes)
    uint128 b;  // Slot 0 (16-31 bytes) âœ… íŒ¨í‚¹ë¨!
    uint256 c;  // Slot 1 (ì „ì²´ ìŠ¬ë¡¯ ì‚¬ìš©)
}
```

**ìŠ¬ë¡¯ ë°°ì¹˜:**
- Slot 0: `a` (16 bytes) + `b` (16 bytes) = 32 bytes âœ…
- Slot 1: `c` (32 bytes)

Storage Slot (32 bytes = 256 bits)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ byte[0] ...                                      ... byte[31]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

(ë§ì´ ì“°ëŠ” ê´€ì : 0~31 ë°”ì´íŠ¸ê°€ í•œ ìŠ¬ë¡¯)
slot[n] = 0x????????????????????????????????????????????????????????????????  (ì´ 64 hex)

slot[0]  â”€â”€â” 32ë°”ì´íŠ¸
slot[1]  â”€â”€â”¤ 32ë°”ì´íŠ¸
slot[2]  â”€â”€â”¤ 32ë°”ì´íŠ¸
...        â”˜

// ì˜ˆì‹œ (ê°œë…)
uint128 a; // 16B
uint64  b; // 8B
uint32  c; // 4B
uint32  d; // 4B
// í•©ê³„: 16 + 8 + 4 + 4 = 32B â†’ ìŠ¬ë¡¯ 1ê°œì— ë”± ë§ê²Œ packing ê°€ëŠ¥

slot[k] (32B)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ a(16B) â”‚ b(8B) â”‚ c(4B) â”‚ d(4B)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

#### ì˜ˆì œ 2: íŒ¨í‚¹ ì‹¤íŒ¨

```solidity
contract NoPacking {
    uint128 a;  // Slot 0 (0-15 bytes)
    uint256 b;  // Slot 1 (ì „ì²´ ìŠ¬ë¡¯ ì‚¬ìš©) - aì™€ íŒ¨í‚¹ ë¶ˆê°€!
    uint128 c;  // Slot 2 (0-15 bytes)
}
```

**ì´ìœ :** `uint256`ì€ 32ë°”ì´íŠ¸ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ë¯€ë¡œ, Slot 0ì— `a`ì™€ í•¨ê»˜ ë“¤ì–´ê°ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

### ë™ì  ë°°ì—´ (Dynamic Array)

ë™ì  íƒ€ì…ì€ "ìŠ¬ë¡¯ 1ê°œì— ê°’ì´ ë°”ë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒ"ì´ ì•„ë‹ˆë¼, ìŠ¬ë¡¯ì„ ì£¼ì†Œ(í¬ì¸í„°/ê¸°ì¤€ì )ì²˜ëŸ¼ ì‚¬ìš©í•˜ê³  ì‹¤ì œ ë°ì´í„°ëŠ” ë‹¤ë¥¸ ìŠ¬ë¡¯ë“¤ì— í©ì–´ì ¸ ì €ì¥ë©ë‹ˆë‹¤.

ë™ì  ë°°ì—´ì˜ ì €ì¥ ë°©ì‹:
1. **ê¸¸ì´ ìŠ¬ë¡¯**: ë°°ì—´ì˜ ê¸¸ì´ë¥¼ ì €ì¥ (ë°°ì—´ì´ ì„ ì–¸ëœ ìŠ¬ë¡¯ ë²ˆí˜¸)
2. **ë°ì´í„° ìŠ¬ë¡¯ë“¤**: ì‹¤ì œ ë°ì´í„°ëŠ” `keccak256(ë°°ì—´ìŠ¬ë¡¯)`ìœ¼ë¡œ ê³„ì‚°ëœ ìœ„ì¹˜ë¶€í„° ì‹œì‘

```solidity
contract DynamicArray {
    uint256[] public arr;  // Slot 0: ê¸¸ì´ ì €ì¥
    // arr[0] -> keccak256(0) ìœ„ì¹˜ (ë§¤ìš° í° ìˆ«ì!)
    // arr[1] -> keccak256(0) + 1 ìœ„ì¹˜
    // arr[2] -> keccak256(0) + 2 ìœ„ì¹˜
}
```

**ì¤‘ìš”í•œ ì˜¤í•´ ë°©ì§€:**
- âŒ **í‹€ë¦° ì´í•´**: arr[0]ì€ Slot 1, arr[1]ì€ Slot 2ì— ì €ì¥
- âœ… **ì˜¬ë°”ë¥¸ ì´í•´**: arr[0]ì€ `keccak256(0)` ìœ„ì¹˜(ì˜ˆ: 1546678032441257452667456735582814959992782782816731922691272282333561699760)ì— ì €ì¥

**ì‹¤ì œ ì˜ˆì‹œ:**
```
Slot 0: arr.length = 3 (ê¸¸ì´ ì •ë³´)

arr[0]ì˜ ì‹¤ì œ ìœ„ì¹˜: keccak256(0) = 0x290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563
                    = 1546678032441257452667456735582814959992782782816731922691272282333561699760 (10ì§„ìˆ˜)

arr[1]ì˜ ì‹¤ì œ ìœ„ì¹˜: keccak256(0) + 1 = 1546678032441257452667456735582814959992782782816731922691272282333561699761
arr[2]ì˜ ì‹¤ì œ ìœ„ì¹˜: keccak256(0) + 2 = 1546678032441257452667456735582814959992782782816731922691272282333561699762
```

**ì™œ ì´ë ‡ê²Œ ë³µì¡í•˜ê²Œ ì €ì¥í•˜ë‚˜ìš”?**
- ë‹¤ë¥¸ ë³€ìˆ˜ë“¤ê³¼ì˜ ì¶©ëŒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ í•´ì‹œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©
- Slot 1, 2, 3... ê°™ì€ ì—°ì†ëœ ìŠ¬ë¡¯ì€ ë‹¤ë¥¸ ë³€ìˆ˜ë“¤ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
- í•´ì‹œë¡œ ê³„ì‚°ëœ ìœ„ì¹˜ëŠ” ê±°ì˜ ì¶©ëŒí•˜ì§€ ì•ŠëŠ” ê³ ìœ í•œ ìœ„ì¹˜ë¥¼ ë³´ì¥

### ë§¤í•‘ (Mapping)

ë§¤í•‘ì€ **í•­ìƒ 1ê°œì˜ ìŠ¬ë¡¯**ë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤ (ê¸¸ì´ ì •ë³´ ì—†ìŒ). ë™ì  ë°°ì—´ê³¼ ë‹¬ë¦¬ ê¸¸ì´ë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

```solidity
contract MappingExample {
    mapping(address => uint256) public balances;  // Slot 0
    // balances[addr] -> keccak256(abi.encode(addr, 0))
}
```

**ê³„ì‚° ê³µì‹:**
```
keccak256(abi.encode(key, slot))
```

#### ë§¤í•‘ì˜ ì €ì¥ ë°©ì‹ (ìƒì„¸ ì„¤ëª…)

**1. ë§¤í•‘ ë³€ìˆ˜ ìì²´:**
- ë§¤í•‘ ë³€ìˆ˜(`balances`)ëŠ” **ìŠ¬ë¡¯ 1ê°œë§Œ ì°¨ì§€**í•©ë‹ˆë‹¤
- ì´ ìŠ¬ë¡¯ì—ëŠ” **ì•„ë¬´ ê°’ë„ ì €ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤** (ë¹ˆ ìŠ¬ë¡¯)
- ë‹¨ì§€ "ì´ ë§¤í•‘ì´ ì‹œì‘ë˜ëŠ” ìœ„ì¹˜"ë¥¼ í‘œì‹œí•˜ëŠ” **ê¸°ì¤€ì ** ì—­í• ë§Œ í•©ë‹ˆë‹¤

**2. ì‹¤ì œ ë°ì´í„° ì €ì¥ ìœ„ì¹˜:**
- `balances[0x123...]`ì˜ ê°’ì€ `keccak256(abi.encode(0x123..., 0))` ìœ„ì¹˜ì— ì €ì¥ë©ë‹ˆë‹¤
- ê° í‚¤ë§ˆë‹¤ ê³ ìœ í•œ í•´ì‹œê°’ì´ ê³„ì‚°ë˜ì–´ ì„œë¡œ ë‹¤ë¥¸ ìœ„ì¹˜ì— ì €ì¥ë©ë‹ˆë‹¤

**ì‹¤ì œ ì˜ˆì‹œ:**
```solidity
contract MappingExample {
    mapping(address => uint256) public balances;  // Slot 0 (ë¹ˆ ìŠ¬ë¡¯, ê¸°ì¤€ì ë§Œ)
    uint256 public totalSupply;                   // Slot 1
}

// ì‚¬ìš© ì˜ˆì‹œ:
balances[0x111...] = 100;  // keccak256(abi.encode(0x111..., 0)) ìœ„ì¹˜ì— 100 ì €ì¥
balances[0x222...] = 200;  // keccak256(abi.encode(0x222..., 0)) ìœ„ì¹˜ì— 200 ì €ì¥
balances[0x333...] = 300;  // keccak256(abi.encode(0x333..., 0)) ìœ„ì¹˜ì— 300 ì €ì¥
```

**ìŠ¬ë¡¯ ë°°ì¹˜ ì‹œê°í™”:**
```
Slot 0: balances (ë¹ˆ ìŠ¬ë¡¯, ê¸°ì¤€ì ë§Œ - ì‹¤ì œ ê°’ ì—†ìŒ)
Slot 1: totalSupply = 1000

ì‹¤ì œ ë°ì´í„°ëŠ” í•´ì‹œë¡œ ê³„ì‚°ëœ ìœ„ì¹˜ì— ì €ì¥:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ balances[0x111...] = 100                               â”‚
â”‚ â†’ keccak256(abi.encode(0x111..., 0)) ìœ„ì¹˜ì— ì €ì¥      â”‚
â”‚ â†’ ì˜ˆ: 5400086938570322021043332052173232972909798328...â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ balances[0x222...] = 200                               â”‚
â”‚ â†’ keccak256(abi.encode(0x222..., 0)) ìœ„ì¹˜ì— ì €ì¥      â”‚
â”‚ â†’ ì™„ì „íˆ ë‹¤ë¥¸ ìœ„ì¹˜ (í•´ì‹œê°’ì´ ë‹¤ë¥´ë¯€ë¡œ)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ë™ì  ë°°ì—´ vs ë§¤í•‘ ë¹„êµ

| íŠ¹ì§• | ë™ì  ë°°ì—´ | ë§¤í•‘ |
|------|----------|------|
| **ê¸¸ì´ ì •ë³´** | âœ… ìˆìŒ (ìŠ¬ë¡¯ì— ì €ì¥) | âŒ ì—†ìŒ |
| **ìŠ¬ë¡¯ ì‚¬ìš©** | 1ê°œ (ê¸¸ì´ ì €ì¥) | 1ê°œ (ë¹ˆ ìŠ¬ë¡¯, ê¸°ì¤€ì ë§Œ) |
| **ë°ì´í„° ìœ„ì¹˜** | `keccak256(slot) + index` | `keccak256(abi.encode(key, slot))` |
| **ì¸ë±ìŠ¤/í‚¤** | ìˆ«ì ì¸ë±ìŠ¤ (0, 1, 2...) | ì„ì˜ì˜ í‚¤ (address, uint256 ë“±) |
| **ìˆœíšŒ ê°€ëŠ¥** | âœ… ê°€ëŠ¥ (ê¸¸ì´ë¥¼ ì•Œ ìˆ˜ ìˆìŒ) | âŒ ë¶ˆê°€ëŠ¥ (ê¸¸ì´ë¥¼ ëª¨ë¦„) |

#### ì™œ ë§¤í•‘ì€ ê¸¸ì´ ì •ë³´ê°€ ì—†ë‚˜ìš”?

1. **ë¬´í•œí•œ í‚¤ ê³µê°„**: ë§¤í•‘ì€ ì´ë¡ ì ìœ¼ë¡œ ë¬´í•œí•œ í‚¤ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤
   - `mapping(address => uint256)`: ëª¨ë“  ì£¼ì†Œ(2^160ê°œ)ê°€ í‚¤ê°€ ë  ìˆ˜ ìˆìŒ
   - ê¸¸ì´ë¥¼ ì €ì¥í•˜ë ¤ë©´ ì—„ì²­ë‚œ ê³µê°„ì´ í•„ìš”í•©ë‹ˆë‹¤

2. **ê°€ìŠ¤ íš¨ìœ¨ì„±**: ê¸¸ì´ë¥¼ ì¶”ì í•˜ì§€ ì•Šì•„ ê°€ìŠ¤ë¹„ê°€ ì ˆì•½ë©ë‹ˆë‹¤

3. **ì‚¬ìš© ëª©ì **: ë§¤í•‘ì€ "íŠ¹ì • í‚¤ì˜ ê°’ì´ ìˆëŠ”ì§€"ë§Œ í™•ì¸í•˜ëŠ” ìš©ë„ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤

#### ì‹¤ì œ ê³„ì‚° ì˜ˆì‹œ

```solidity
contract Example {
    mapping(address => uint256) public balances;  // Slot 0
}

// balances[0x1234567890123456789012345678901234567890] = 1000 ì„¤ì • ì‹œ:

// 1. ë§¤í•‘ ìŠ¬ë¡¯: 0
// 2. í‚¤: 0x1234567890123456789012345678901234567890
// 3. ê³„ì‚°: keccak256(abi.encode(0x1234..., 0))
// 4. ê²°ê³¼: ë§¤ìš° í° ìˆ«ì (ì˜ˆ: 54000869385703220210433320521732329729097983288105988100178786023677858612074)
// 5. ì´ ìœ„ì¹˜ì— ê°’ 1000 ì €ì¥
```

**ì¤‘ìš”í•œ í¬ì¸íŠ¸:**
- ë§¤í•‘ ë³€ìˆ˜ ìì²´(`balances`)ëŠ” Slot 0ì— ìˆì§€ë§Œ **ë¹„ì–´ìˆìŠµë‹ˆë‹¤**
- ì‹¤ì œ ë°ì´í„°ëŠ” í•´ì‹œë¡œ ê³„ì‚°ëœ **ì™„ì „íˆ ë‹¤ë¥¸ ìœ„ì¹˜**ì— ì €ì¥ë©ë‹ˆë‹¤
- ê° í‚¤ë§ˆë‹¤ **ê³ ìœ í•œ ìœ„ì¹˜**ê°€ ê³„ì‚°ë˜ì–´ ì¶©ëŒ ì—†ì´ ì €ì¥ë©ë‹ˆë‹¤

---


#### **2ë‹¨ê³„: Practice ì‹¤ìŠµ** (1ì‹œê°„)
`step01_practice/` í´ë”ì—ì„œ ì˜ˆì œ ì½”ë“œë¥¼ ë”°ë¼í•˜ë©° ì‹¤ìŠµí•©ë‹ˆë‹¤.

```bash
# step01_practice í´ë”ë¡œ ì´ë™
cd Day1/01-storage-layout/step01_practice

# 1. ì»¨íŠ¸ë™íŠ¸ ì»´íŒŒì¼
forge build
```

**ëª…ë ¹ì–´ ì‹¤í–‰ ê³¼ì • ì„¤ëª…:**

```
[â Š] Compiling...
```
- **ì˜ë¯¸**: ì»´íŒŒì¼ì´ ì§„í–‰ ì¤‘ì„ì„ ë‚˜íƒ€ë‚´ëŠ” ì• ë‹ˆë©”ì´ì…˜ ì•„ì´ì½˜
- **ìƒíƒœ**: Solidity íŒŒì¼ë“¤ì„ ì½ê³  ë¶„ì„í•˜ëŠ” ì¤‘

```
[â ¢] Compiling 21 files with Solc 0.8.20
```
- **ì˜ë¯¸**: ì´ 21ê°œì˜ íŒŒì¼ì„ Solidity ì»´íŒŒì¼ëŸ¬ 0.8.20 ë²„ì „ìœ¼ë¡œ ì»´íŒŒì¼ ì¤‘
- **21ê°œ íŒŒì¼**: 
  - ìš°ë¦¬ê°€ ì‘ì„±í•œ íŒŒì¼: `StorageLayout.sol`, `StorageLayout.t.sol`
  - ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒŒì¼: `forge-std`ì˜ ì—¬ëŸ¬ íŒŒì¼ë“¤ (Test.sol, console.sol ë“±)

```
[â †] Solc 0.8.20 finished in 1.18s
```
- **ì˜ë¯¸**: Solidity ì»´íŒŒì¼ëŸ¬ê°€ 1.18ì´ˆ ë§Œì— ì»´íŒŒì¼ ì™„ë£Œ
- **Solc**: Solidity Compilerì˜ ì•½ì

```
Compiler run successful!
```
- **ì˜ë¯¸**: ì»´íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë¨
- **ì—ëŸ¬ê°€ ì—†ìœ¼ë©´**: ì´ ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ê³  ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ ê°€ëŠ¥

**ìƒì„±ë˜ëŠ” ë””ë ‰í† ë¦¬:**

**1. `out/` ë””ë ‰í† ë¦¬ (ì»´íŒŒì¼ ê²°ê³¼ë¬¼)**
- **ì—­í• **: ì»´íŒŒì¼ëœ ì»¨íŠ¸ë™íŠ¸ì˜ ë°”ì´íŠ¸ì½”ë“œì™€ ë©”íƒ€ë°ì´í„° ì €ì¥
- **ì£¼ìš” ë‚´ìš©**:
  - `StorageLayout.sol/StorageLayout.json`: ì»´íŒŒì¼ëœ StorageLayout ì»¨íŠ¸ë™íŠ¸ ì •ë³´
    - ABI (Application Binary Interface)
    - Bytecode (ë°°í¬ìš© ë°”ì´íŠ¸ì½”ë“œ)
    - DeployedBytecode (ë°°í¬ í›„ ë°”ì´íŠ¸ì½”ë“œ)
    - Storage Layout (ìŠ¬ë¡¯ ë°°ì¹˜ ì •ë³´) â­ **forge inspectê°€ ì—¬ê¸°ì„œ ì½ì–´ì˜´**
  - `StorageLayout.t.sol/StorageLayoutTest.json`: í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë™íŠ¸ ì •ë³´
  - `build-info/`: ë¹Œë“œ ë©”íƒ€ë°ì´í„° (ì¬ì»´íŒŒì¼ ìµœì í™”ìš©)
  - ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒŒì¼ë“¤ì˜ ì»´íŒŒì¼ ê²°ê³¼ë¬¼

**2. `cache/` ë””ë ‰í† ë¦¬ (ìºì‹œ íŒŒì¼)**
- **ì—­í• **: ì»´íŒŒì¼ ì†ë„ í–¥ìƒì„ ìœ„í•œ ìºì‹œ íŒŒì¼ ì €ì¥
- **ì£¼ìš” ë‚´ìš©**:
  - `solidity-files-cache.json`: íŒŒì¼ ë³€ê²½ ê°ì§€ ë° ì¦ë¶„ ì»´íŒŒì¼ì„ ìœ„í•œ ìºì‹œ
  - **ì‘ë™ ì›ë¦¬**: 
    - íŒŒì¼ì´ ë³€ê²½ë˜ì§€ ì•Šìœ¼ë©´ ìºì‹œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹ ë¥´ê²Œ ì»´íŒŒì¼
    - íŒŒì¼ì´ ë³€ê²½ë˜ë©´ í•´ë‹¹ íŒŒì¼ë§Œ ë‹¤ì‹œ ì»´íŒŒì¼
    - "No files changed, compilation skipped" ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ë©´ ìºì‹œ ì‚¬ìš©

**ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ:**
```bash
# ì²« ë²ˆì§¸ ì»´íŒŒì¼ (ëŠë¦¼ - ëª¨ë“  íŒŒì¼ ì»´íŒŒì¼)
forge build
# â†’ 21ê°œ íŒŒì¼ ëª¨ë‘ ì»´íŒŒì¼, 1.18ì´ˆ ì†Œìš”

# ë‘ ë²ˆì§¸ ì»´íŒŒì¼ (ë¹ ë¦„ - ìºì‹œ ì‚¬ìš©)
forge build
# â†’ "No files changed, compilation skipped" (ê±°ì˜ ì¦‰ì‹œ ì™„ë£Œ)

# íŒŒì¼ ìˆ˜ì • í›„ ì»´íŒŒì¼ (ì¤‘ê°„ ì†ë„ - ë³€ê²½ëœ íŒŒì¼ë§Œ ì»´íŒŒì¼)
# StorageLayout.sol ìˆ˜ì • í›„
forge build
# â†’ StorageLayout.solë§Œ ë‹¤ì‹œ ì»´íŒŒì¼, ë‚˜ë¨¸ì§€ëŠ” ìºì‹œ ì‚¬ìš©
```

**ì¤‘ìš”í•œ íŒŒì¼ ìœ„ì¹˜:**
- `out/StorageLayout.sol/StorageLayout.json`: Storage Layout ì •ë³´ê°€ ì—¬ê¸° ì €ì¥ë¨
- `forge inspect StorageLayout storageLayout` ëª…ë ¹ì–´ëŠ” ì´ JSON íŒŒì¼ì—ì„œ ì •ë³´ë¥¼ ì½ì–´ì˜µë‹ˆë‹¤

# 2. Storage Layout í™•ì¸
forge inspect StorageLayout storageLayout

# 3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰
forge test -vv

# 4. í…ŒìŠ¤íŠ¸ë¥¼ ë³´ë©´ì„œ ì½”ë“œ ì´í•´í•˜ê¸°
# StorageLayout.solê³¼ StorageLayout.t.solì„ í•¨ê»˜ ë³´ì„¸ìš”
```

**ì‹¤ìŠµ ë‚´ìš©:**
- `StorageLayout.sol`ì˜ ë³€ìˆ˜ë“¤ì´ ì–´ë–»ê²Œ ìŠ¬ë¡¯ì— ì €ì¥ë˜ëŠ”ì§€ í™•ì¸
- `readSlot()` í•¨ìˆ˜ë¡œ ì‹¤ì œ ìŠ¬ë¡¯ ê°’ ì½ì–´ë³´ê¸°
- `readArraySlot()` í•¨ìˆ˜ë¡œ ë™ì  ë°°ì—´ ìŠ¬ë¡¯ ê³„ì‚°í•˜ê¸°
- `readMappingSlot()` í•¨ìˆ˜ë¡œ ë§¤í•‘ ìŠ¬ë¡¯ ê³„ì‚°í•˜ê¸°
- í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©° ê²°ê³¼ í™•ì¸

#### **3ë‹¨ê³„: ì—°ìŠµë¬¸ì œ í’€ê¸°** (1-2ì‹œê°„)
`step02_exercises/` í´ë”ì˜ ë¬¸ì œë¥¼ ì§ì ‘ í’€ì–´ë´…ë‹ˆë‹¤.

**step02_exercises í´ë”ì˜ ì—­í• :**
- **ëª©ì **: `step01_practice/`ì—ì„œ ë°°ìš´ ë‚´ìš©ì„ ì§ì ‘ ì ìš©í•˜ì—¬ ì‹¤ë ¥ í–¥ìƒ
- **ì°¨ì´ì **: 
  - `step01_practice/`: ì™„ì„±ëœ ì˜ˆì œ ì½”ë“œ ì œê³µ (ë”°ë¼í•˜ê¸°)
  - `step02_exercises/`: ë¹ˆ íŒŒì¼ ì œê³µ (ì§ì ‘ ì‘ì„±í•´ì•¼ í•¨)
- **í•™ìŠµ íš¨ê³¼**: 
  - ì´ë¡ ì„ ì‹¤ì œë¡œ ì ìš©í•´ë³´ë©° í™•ì‹¤íˆ ì´í•´
  - ë¬¸ì œ í•´ê²° ëŠ¥ë ¥ í–¥ìƒ
  - ë©´ì ‘ì´ë‚˜ ì‹¤ë¬´ì—ì„œ ìœ ìš©í•œ ì‹¤ì „ ê²½í—˜

```bash
# step02_exercises í´ë”ë¡œ ì´ë™
cd Day1/01-storage-layout/step02_exercises

# 1. EXERCISES.md íŒŒì¼ ì—´ê¸° (ë¬¸ì œ ì„¤ëª… í™•ì¸)
# 2. StorageLayout.sol íŒŒì¼ì— ë¬¸ì œ í’€ê¸°
# 3. foundry.toml ìƒì„± (í•„ìš”ì‹œ)
# 4. forge buildë¡œ ì»´íŒŒì¼
# 5. forge inspectë¡œ ê²€ì¦
```

**ë¬¸ì œ ëª©ë¡:**
1. **ë¬¸ì œ 1**: ê¸°ë³¸ ìŠ¬ë¡¯ ê³„ì‚° (ë³€ìˆ˜ íŒ¨í‚¹)
   - ì†ìœ¼ë¡œ ê³„ì‚° â†’ ì½”ë“œ ì‘ì„± â†’ ê²€ì¦
2. **ë¬¸ì œ 2**: ë™ì  ë°°ì—´ ìŠ¬ë¡¯ ê³„ì‚°
   - `keccak256` ê³„ì‚° â†’ ìŠ¬ë¡¯ ìœ„ì¹˜ í™•ì¸
3. **ë¬¸ì œ 3**: ë§¤í•‘ ìŠ¬ë¡¯ ê³„ì‚°
   - ë§¤í•‘ ìŠ¬ë¡¯ ê³„ì‚° ê³µì‹ ì ìš©
4. **ë¬¸ì œ 4**: ë³€ìˆ˜ íŒ¨í‚¹ ìµœì í™”
   - ê°€ìŠ¤ë¹„ ì ˆì•½ì„ ìœ„í•œ ë³€ìˆ˜ ìˆœì„œ ì¬ë°°ì¹˜
5. **ë¬¸ì œ 5**: ì¤‘ì²© êµ¬ì¡°ì²´ ë¶„ì„
   - êµ¬ì¡°ì²´ì™€ ë§¤í•‘ì˜ ë³µí•© êµ¬ì¡° ì´í•´

**ê° ë¬¸ì œ í’€ì´ ìˆœì„œ:**
1. **ë¬¸ì œ ì½ê¸°**: `EXERCISES.md`ì—ì„œ ë¬¸ì œì™€ íŒíŠ¸ í™•ì¸
2. **ì†ìœ¼ë¡œ ê³„ì‚°**: ë¨¼ì € ì¢…ì´ì— ìŠ¬ë¡¯ ë°°ì¹˜ ê³„ì‚°
3. **ì½”ë“œ ì‘ì„±**: `StorageLayout.sol`ì— ì»¨íŠ¸ë™íŠ¸ ì‘ì„±
4. **ì»´íŒŒì¼**: `forge build`ë¡œ ë¬¸ë²• ì˜¤ë¥˜ í™•ì¸
5. **ê²€ì¦**: `forge inspect`ë¡œ ì‹¤ì œ ìŠ¬ë¡¯ ë°°ì¹˜ í™•ì¸
6. **ì •ë‹µ ë¹„êµ**: README.mdì˜ ì •ë‹µê³¼ ë¹„êµ

**step02_exercises í´ë” ì‚¬ìš© íŒ:**
- ì²˜ìŒì—ëŠ” íŒíŠ¸ë¥¼ ë§ì´ ì°¸ê³ í•´ë„ ë©ë‹ˆë‹¤
- ì •ë‹µì„ ë³´ê¸° ì „ì— ìµœëŒ€í•œ ìŠ¤ìŠ¤ë¡œ í’€ì–´ë³´ì„¸ìš”
- `step01_practice/` í´ë”ì˜ ì½”ë“œë¥¼ ì°¸ê³ í•´ë„ ë©ë‹ˆë‹¤
- ê° ë¬¸ì œë¥¼ ì™„ë£Œí•˜ë©´ ì²´í¬ë¦¬ìŠ¤íŠ¸ì— ì²´í¬í•˜ì„¸ìš”

#### **4ë‹¨ê³„: Assembly ì‹¬í™”** (ì„ íƒ, 30ë¶„)
Assemblyë¥¼ ì‚¬ìš©í•œ Storage ì§ì ‘ ì ‘ê·¼ ë°©ë²• í•™ìŠµ

#### **5ë‹¨ê³„: ì²´í¬ë¦¬ìŠ¤íŠ¸ í™•ì¸**
ëª¨ë“  í•­ëª©ì„ ì™„ë£Œí–ˆëŠ”ì§€ í™•ì¸í•˜ê³ , ë©´ì ‘ ëŒ€ë¹„ ì§ˆë¬¸ìœ¼ë¡œ ë³µìŠµ

---

### ğŸ› ï¸ ì‹¤ìŠµ í™˜ê²½ ì„¤ì •

#### í•„ìˆ˜ ë„êµ¬
- **Foundry**: Solidity ê°œë°œ ë° í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬
- **VS Code** (ë˜ëŠ” ë‹¤ë¥¸ ì—ë””í„°): ì½”ë“œ í¸ì§‘

#### Foundry ì„¤ì¹˜ í™•ì¸
```bash
forge --version
cast --version
```

#### ì‹¤ìŠµ ì‹œì‘í•˜ê¸°

**Practice ì‹¤ìŠµ ì‹œì‘:**
```bash
cd Day1/01-storage-layout/step01_practice

# 1. ì˜ì¡´ì„± ì„¤ì¹˜ (ì²˜ìŒ í•œ ë²ˆë§Œ)
forge install

# 2. ì»´íŒŒì¼
forge build

# 3. Storage Layout í™•ì¸
forge inspect StorageLayout storageLayout

# ì¶œë ¥ ì˜ˆì‹œ:
# | Name         | Type    | Slot | Offset | Bytes | Contract        |
# |--------------|---------|------|--------|-------|-----------------|
# | a            | uint8   | 0    | 0      | 1     | StorageLayout   |
# | b            | uint16  | 0    | 1      | 2     | StorageLayout   |
# | c            | uint256 | 1    | 0      | 32    | StorageLayout   |
# ...

# 4. í…ŒìŠ¤íŠ¸ ì‹¤í–‰
forge test -vv

# 5. íŠ¹ì • í…ŒìŠ¤íŠ¸ë§Œ ì‹¤í–‰
forge test --match-test test_VariablePacking -vv
```

**Exercises ë¬¸ì œ í’€ê¸°:**
```bash
cd Day1/01-storage-layout/step02_exercises

# 1. EXERCISES.md íŒŒì¼ ì—´ê¸°
# 2. ë¬¸ì œë¥¼ í•˜ë‚˜ì”© ì½ê³  í’€ê¸°
# 3. StorageLayout.solì— ì½”ë“œ ì‘ì„±
# 4. forge buildë¡œ ì»´íŒŒì¼ í™•ì¸
# 5. forge inspectë¡œ ìŠ¬ë¡¯ ë°°ì¹˜ í™•ì¸
```

---

### ğŸ“– ë‹¨ê³„ë³„ ìƒì„¸ ê°€ì´ë“œ

#### **Step 1: ì´ë¡  í•™ìŠµ (README.md ì½ê¸°)**

1. **EVM Storage ê¸°ë³¸ êµ¬ì¡°** ì„¹ì…˜ ì½ê¸°
   - 32ë°”ì´íŠ¸ ìŠ¬ë¡¯ ê°œë… ì´í•´
   - 2^256ê°œì˜ ìŠ¬ë¡¯ êµ¬ì¡° íŒŒì•…

2. **ë³€ìˆ˜ íŒ¨í‚¹** ì„¹ì…˜ ì½ê¸°
   - íŒ¨í‚¹ ê·œì¹™ 3ê°€ì§€ ì™¸ìš°ê¸°
   - ì˜ˆì œ 1, 2ë¥¼ ë³´ë©° íŒ¨í‚¹ ì„±ê³µ/ì‹¤íŒ¨ ì¼€ì´ìŠ¤ ì´í•´

3. **ë™ì  ë°°ì—´ê³¼ ë§¤í•‘** ì„¹ì…˜ ì½ê¸°
   - `keccak256`ì„ ì‚¬ìš©í•œ ìŠ¬ë¡¯ ê³„ì‚° ê³µì‹ ì´í•´
   - ê°ê°ì˜ ì €ì¥ ë°©ì‹ ì°¨ì´ì  íŒŒì•…

#### **Step 2: Practice ì‹¤ìŠµ**

**2-1. StorageLayout.sol ì½”ë“œ ì½ê¸°**
```bash
cd step01_practice
cat StorageLayout.sol
```

**2-2. Storage Layout í™•ì¸**
```bash
forge inspect StorageLayout storageLayout
```
ì¶œë ¥ëœ í…Œì´ë¸”ì„ ë³´ë©°:
- ê° ë³€ìˆ˜ê°€ ì–´ëŠ ìŠ¬ë¡¯ì— ì €ì¥ë˜ëŠ”ì§€ í™•ì¸
- íŒ¨í‚¹ì´ ì–´ë–»ê²Œ ì´ë£¨ì–´ì§€ëŠ”ì§€ ê´€ì°°

**2-3. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‹¤í–‰**
```bash
forge test -vv
```

**2-4. í…ŒìŠ¤íŠ¸ ì½”ë“œ ìˆ˜ì •í•˜ë©° ì‹¤ìŠµ**
`StorageLayout.t.sol`ì„ ì—´ê³ :
- `test_VariablePacking()` í•¨ìˆ˜ì˜ TODO ë¶€ë¶„ ì™„ì„±
- `console.log`ë¡œ ìŠ¬ë¡¯ ê°’ ì¶œë ¥ í™•ì¸
- ê° ìŠ¬ë¡¯ì— ì–´ë–¤ ê°’ì´ ì €ì¥ë˜ëŠ”ì§€ ê´€ì°°

**2-5. ì§ì ‘ ê°’ ì„¤ì •í•˜ê³  í™•ì¸**
```solidity
// StorageLayout.solì˜ setter í•¨ìˆ˜ ì‚¬ìš©
storageLayout.set_a(100);
storageLayout.set_b(200);

// ìŠ¬ë¡¯ 0 ì½ê¸°
bytes32 slot0 = storageLayout.readSlot(0);
// slot0ì—ëŠ” aì™€ bê°€ íŒ¨í‚¹ë˜ì–´ ì €ì¥ë¨
```

#### **Step 3: Exercises ë¬¸ì œ í’€ê¸°**

**ë¬¸ì œ 1: ê¸°ë³¸ ìŠ¬ë¡¯ ê³„ì‚°**
1. `step02_exercises/StorageLayout.sol`ì— `Exercise1` ì»¨íŠ¸ë™íŠ¸ ì‘ì„±
2. ê° ë³€ìˆ˜ì˜ ìŠ¬ë¡¯ ìœ„ì¹˜ë¥¼ ì†ìœ¼ë¡œ ê³„ì‚°
3. `forge inspect Exercise1 storageLayout`ë¡œ ê²€ì¦

**ë¬¸ì œ 2: ë™ì  ë°°ì—´**
1. `keccak256(0)` ê³„ì‚° (JavaScript ë˜ëŠ” Solidity)
2. `readArraySlot()` í•¨ìˆ˜ êµ¬í˜„
3. ì‹¤ì œ ê°’ ì„¤ì • í›„ ìŠ¬ë¡¯ì—ì„œ ì½ì–´ë³´ê¸°

**ë¬¸ì œ 3: ë§¤í•‘**
1. `keccak256(abi.encode(addr, slot))` ê³„ì‚°
2. `readMappingSlot()` í•¨ìˆ˜ êµ¬í˜„
3. ê°’ ì„¤ì • í›„ ê²€ì¦

**ë¬¸ì œ 4: ìµœì í™”**
1. ë¹„íš¨ìœ¨ì ì¸ ì½”ë“œ ë¶„ì„
2. ë³€ìˆ˜ ìˆœì„œ ì¬ë°°ì¹˜
3. ìŠ¬ë¡¯ ì‚¬ìš©ëŸ‰ ë¹„êµ

#### **Step 4: Assembly ì‹¬í™” (ì„ íƒ)**

Assembly ì„¹ì…˜ì„ ì½ê³ :
- `sload()` í•¨ìˆ˜ë¡œ ìŠ¬ë¡¯ ì§ì ‘ ì½ê¸°
- `keccak256()` ê³„ì‚°ì„ Assemblyë¡œ êµ¬í˜„
- ê³ ê¸‰ Storage ì¡°ì‘ ë°©ë²• í•™ìŠµ

---

### âœ… í•™ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

ê° ë‹¨ê³„ë¥¼ ì™„ë£Œí•˜ë©´ ì²´í¬í•˜ì„¸ìš”:

**ì´ë¡  í•™ìŠµ**
- [ ] EVM Storage ê¸°ë³¸ êµ¬ì¡° ì´í•´
- [ ] ë³€ìˆ˜ íŒ¨í‚¹ ê·œì¹™ 3ê°€ì§€ ì™¸ìš°ê¸°
- [ ] ë™ì  ë°°ì—´ ìŠ¬ë¡¯ ê³„ì‚° ê³µì‹ ì´í•´
- [ ] ë§¤í•‘ ìŠ¬ë¡¯ ê³„ì‚° ê³µì‹ ì´í•´
- [ ] keccak256 í•´ì‹œ í•¨ìˆ˜ ê°œë… ì´í•´

**Practice ì‹¤ìŠµ**
- [ ] `forge inspect`ë¡œ Storage Layout í™•ì¸í•´ë´¤ë‹¤
- [ ] `readSlot()` í•¨ìˆ˜ë¡œ ìŠ¬ë¡¯ ê°’ ì½ì–´ë´¤ë‹¤
- [ ] `readArraySlot()` í•¨ìˆ˜ êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸
- [ ] `readMappingSlot()` í•¨ìˆ˜ êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸
- [ ] í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‹¤í–‰ ë° ê²°ê³¼ í™•ì¸

**Exercises ë¬¸ì œ**
- [ ] ë¬¸ì œ 1: ê¸°ë³¸ ìŠ¬ë¡¯ ê³„ì‚° ì™„ë£Œ
- [ ] ë¬¸ì œ 2: ë™ì  ë°°ì—´ ìŠ¬ë¡¯ ê³„ì‚° ì™„ë£Œ
- [ ] ë¬¸ì œ 3: ë§¤í•‘ ìŠ¬ë¡¯ ê³„ì‚° ì™„ë£Œ
- [ ] ë¬¸ì œ 4: ë³€ìˆ˜ íŒ¨í‚¹ ìµœì í™” ì™„ë£Œ
- [ ] ë¬¸ì œ 5: ì¤‘ì²© êµ¬ì¡°ì²´ ë¶„ì„ ì™„ë£Œ

**ì‹¬í™” í•™ìŠµ**
- [ ] Assemblyë¥¼ ì‚¬ìš©í•œ Storage ì§ì ‘ ì ‘ê·¼ ì´í•´
- [ ] ë©´ì ‘ ëŒ€ë¹„ ì§ˆë¬¸ ë‹µë³€ ê°€ëŠ¥

---

### ğŸš¨ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ì™€ í•´ê²°ë²•

**ì‹¤ìˆ˜ 1: `forge inspect` ì—ëŸ¬**
```
Error: No contract found with the name `StorageLayout`
```
**í•´ê²°:** 
- `step01_practice/` í´ë”ì—ì„œ ì‹¤í–‰í–ˆëŠ”ì§€ í™•ì¸
- `forge build` ë¨¼ì € ì‹¤í–‰
- ì»¨íŠ¸ë™íŠ¸ ì´ë¦„ì´ ì •í™•í•œì§€ í™•ì¸ (íŒŒì¼ëª…ì´ ì•„ë‹˜!)

**ì‹¤ìˆ˜ 2: ìŠ¬ë¡¯ ê³„ì‚°ì´ ë§ì§€ ì•ŠìŒ**
**í•´ê²°:**
- ë³€ìˆ˜ ì„ ì–¸ ìˆœì„œ í™•ì¸ (ì¤‘ìš”!)
- íŒ¨í‚¹ ê·œì¹™ ë‹¤ì‹œ í™•ì¸
- `forge inspect`ë¡œ ì‹¤ì œ ê°’ê³¼ ë¹„êµ

**ì‹¤ìˆ˜ 3: keccak256 ê³„ì‚°ì´ ë³µì¡í•¨**
**í•´ê²°:**
- `readArraySlot()`, `readMappingSlot()` í•¨ìˆ˜ í™œìš©
- JavaScriptë¡œ ë¨¼ì € ê³„ì‚°í•´ë³´ê³  Solidityì™€ ë¹„êµ

---

### ğŸ’¡ í•™ìŠµ íŒ

1. **ì†ìœ¼ë¡œ ë¨¼ì € ê³„ì‚°í•˜ê¸°**
   - ìŠ¬ë¡¯ ê³„ì‚°ì€ ë¨¼ì € ì†ìœ¼ë¡œ í•´ë³´ê³ , ê·¸ ë‹¤ìŒ ì½”ë“œë¡œ ê²€ì¦

2. **`forge inspect` ì ê·¹ í™œìš©**
   - ì´ë¡ ê³¼ ì‹¤ì œê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê°€ì¥ ì¢‹ì€ ë°©ë²•

3. **í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±í•˜ê¸°**
   - `assertEq()`ë¡œ ì˜ˆìƒê°’ê³¼ ì‹¤ì œê°’ ë¹„êµ
   - `console.log()`ë¡œ ì¤‘ê°„ ê³¼ì • í™•ì¸

4. **ë‹¨ê³„ë³„ë¡œ ì²œì²œíˆ**
   - í•œ ë²ˆì— ëª¨ë“  ê²ƒì„ ì´í•´í•˜ë ¤ í•˜ì§€ ë§ê³ , ê° ê°œë…ì„ í•˜ë‚˜ì”© í™•ì‹¤íˆ

5. **ì—°ìŠµë¬¸ì œëŠ” ë°˜ë“œì‹œ ì§ì ‘ í’€ê¸°**
   - ë³´ê¸°ë§Œ í•˜ì§€ ë§ê³  ì§ì ‘ ì½”ë“œ ì‘ì„±í•´ë³´ê¸°

---


## ğŸ“ ì—°ìŠµë¬¸ì œ (Exercises í´ë”)

> ğŸ’¡ **ì¤‘ìš”:** ì´ ì„¹ì…˜ì˜ ë¬¸ì œë“¤ì€ `step02_exercises/` í´ë”ì—ì„œ ì§ì ‘ í’€ì–´ì•¼ í•©ë‹ˆë‹¤.
> ìì„¸í•œ ë¬¸ì œ ì„¤ëª…ê³¼ íŒíŠ¸ëŠ” `step02_exercises/EXERCISES.md` íŒŒì¼ì„ ì°¸ê³ í•˜ì„¸ìš”.

### ë¬¸ì œ 1: ìŠ¬ë¡¯ ê³„ì‚° (ê¸°ë³¸)

**íŒŒì¼:** `step02_exercises/StorageLayout.sol`

ë‹¤ìŒ ì»¨íŠ¸ë™íŠ¸ì—ì„œ ê° ë³€ìˆ˜ê°€ ì–´ëŠ ìŠ¬ë¡¯ì— ì €ì¥ë˜ëŠ”ì§€ ê³„ì‚°í•˜ì„¸ìš”:

```solidity
contract Exercise1 {
    uint8 a;
    uint16 b;
    uint256 c;
    uint64 d;
    uint64 e;
    uint128 f;
}
```

**ê³¼ì œ:**
1. ê° ë³€ìˆ˜ì˜ ìŠ¬ë¡¯ ìœ„ì¹˜ë¥¼ ì†ìœ¼ë¡œ ê³„ì‚°
2. `step02_exercises/StorageLayout.sol`ì— `Exercise1` ì»¨íŠ¸ë™íŠ¸ ì‘ì„±
3. `forge inspect Exercise1 storageLayout`ë¡œ ê²€ì¦

**íŒíŠ¸:**
- ë³€ìˆ˜ëŠ” ì„ ì–¸ ìˆœì„œëŒ€ë¡œ ì €ì¥ë¨
- 32ë°”ì´íŠ¸ë³´ë‹¤ ì‘ì€ ë³€ìˆ˜ë“¤ì€ ê°™ì€ ìŠ¬ë¡¯ì— íŒ¨í‚¹ ê°€ëŠ¥
- `uint256`ì€ í•­ìƒ ìŠ¬ë¡¯ 1ê°œë¥¼ í†µì§¸ë¡œ ì‚¬ìš©

<details>
<summary>ì •ë‹µ ë³´ê¸°</summary>

- Slot 0: `a` (1 byte) + `b` (2 bytes) + ë¹ˆ ê³µê°„ (13 bytes) + `d` (8 bytes) + `e` (8 bytes) = 32 bytes
- Slot 1: `c` (32 bytes)
- Slot 2: `f` (16 bytes)

**ì´ìœ :** `uint256 c`ëŠ” 32ë°”ì´íŠ¸ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ë¯€ë¡œ Slot 0ì— ë“¤ì–´ê°ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
</details>

### ë¬¸ì œ 2: ë™ì  ë°°ì—´ ìŠ¬ë¡¯ ê³„ì‚°

**íŒŒì¼:** `step02_exercises/StorageLayout.sol`

ë‹¤ìŒ ì»¨íŠ¸ë™íŠ¸ì—ì„œ `arr[0]`ê³¼ `arr[1]`ì´ ì €ì¥ë˜ëŠ” ìŠ¬ë¡¯ì„ ê³„ì‚°í•˜ì„¸ìš”:

```solidity
contract Exercise2 {
    uint256[] public arr;  // Slot 0
}
```

**ê³¼ì œ:**
1. `keccak256(0)` ê³„ì‚° (JavaScript ë˜ëŠ” Solidity)
2. `arr[1]`ì˜ ìŠ¬ë¡¯ ê³„ì‚° (`keccak256(0) + 1`)
3. `readArraySlot()` í•¨ìˆ˜ë¡œ ê²€ì¦

**ê³„ì‚° ë°©ë²•:**
```javascript
// JavaScript (Node.js)
const { keccak256 } = require('ethers');
const slot = 0;
const index0Slot = keccak256(new Uint8Array(32).fill(0));
console.log("arr[0] slot:", index0Slot);
```

```solidity
// Solidity
uint256 slot = 0;
uint256 index0Slot = uint256(keccak256(abi.encode(slot)));
uint256 index1Slot = index0Slot + 1;
```

<details>
<summary>ì •ë‹µ ë³´ê¸°</summary>

- `arr.length` â†’ Slot 0
- `arr[0]` â†’ `keccak256(0)`
- `arr[1]` â†’ `keccak256(0) + 1`

**ê²€ì¦:**
```bash
cd step02_exercises
forge inspect Exercise2 storageLayout
```
</details>

### ë¬¸ì œ 3: ë§¤í•‘ ìŠ¬ë¡¯ ê³„ì‚°

**íŒŒì¼:** `step02_exercises/StorageLayout.sol`

ë‹¤ìŒ ì»¨íŠ¸ë™íŠ¸ì—ì„œ `balances[0x123...]`ì´ ì €ì¥ë˜ëŠ” ìŠ¬ë¡¯ì„ ê³„ì‚°í•˜ì„¸ìš”:

```solidity
contract Exercise3 {
    mapping(address => uint256) public balances;  // Slot 1
    uint256 public totalSupply;  // Slot 0
}
```

**ê³¼ì œ:**
1. `keccak256(abi.encode(addr, 1))` ê³„ì‚°
2. `readMappingSlot()` í•¨ìˆ˜ë¡œ ê²€ì¦
3. ì‹¤ì œ ê°’ ì„¤ì • í›„ í•´ë‹¹ ìŠ¬ë¡¯ì—ì„œ ì½ì–´ë³´ê¸°

**ê³„ì‚° ë°©ë²•:**
```solidity
address addr = 0x1234567890123456789012345678901234567890;
uint256 mappingSlot = 1;
uint256 calculatedSlot = uint256(keccak256(abi.encode(addr, mappingSlot)));
```

<details>
<summary>ì •ë‹µ ë³´ê¸°</summary>

- `totalSupply` â†’ Slot 0
- `balances[addr]` â†’ `keccak256(abi.encode(addr, 1))`

**ê²€ì¦ ì½”ë“œ:**
```solidity
function test_MappingSlot() public {
    address testAddr = address(0x123);
    uint256 amount = 1000;
    
    balances[testAddr] = amount;
    
    uint256 calculatedSlot = uint256(keccak256(abi.encode(testAddr, uint256(1))));
    bytes32 value = readSlot(calculatedSlot);
    assertEq(uint256(value), amount);
}
```
</details>

### ë¬¸ì œ 4: ë³€ìˆ˜ íŒ¨í‚¹ ìµœì í™”

**íŒŒì¼:** `step02_exercises/StorageLayout.sol`

ë‹¤ìŒ ì»¨íŠ¸ë™íŠ¸ì˜ ê°€ìŠ¤ë¥¼ ìµœì í™”í•˜ê¸° ìœ„í•´ ë³€ìˆ˜ ìˆœì„œë¥¼ ì¬ë°°ì¹˜í•˜ì„¸ìš”:

```solidity
contract Inefficient {
    uint256 a;  // 32 bytes - Slot 0
    uint8 b;    // 1 byte - Slot 1 (íŒ¨í‚¹ ì‹¤íŒ¨!)
    uint256 c;  // 32 bytes - Slot 2
    uint8 d;    // 1 byte - Slot 3 (íŒ¨í‚¹ ì‹¤íŒ¨!)
    // ì´ 4ê°œ ìŠ¬ë¡¯ ì‚¬ìš©
}
```

**ëª©í‘œ:** ê°™ì€ ê¸°ëŠ¥ì„ ìœ ì§€í•˜ë©´ì„œ ìŠ¬ë¡¯ ì‚¬ìš©ì„ ìµœì†Œí™”í•˜ì„¸ìš”.

**ê³¼ì œ:**
1. ë¹„íš¨ìœ¨ì ì¸ ì½”ë“œ ë¶„ì„
2. ë³€ìˆ˜ ìˆœì„œ ì¬ë°°ì¹˜
3. `forge inspect`ë¡œ ìŠ¬ë¡¯ ì‚¬ìš©ëŸ‰ ë¹„êµ

<details>
<summary>ì •ë‹µ ë³´ê¸°</summary>

```solidity
contract Optimized {
    uint8 b;    // 1 byte - Slot 0
    uint8 d;    // 1 byte - Slot 0 (íŒ¨í‚¹ ì„±ê³µ!)
    uint256 a;  // 32 bytes - Slot 1
    uint256 c;  // 32 bytes - Slot 2
    // ì´ 3ê°œ ìŠ¬ë¡¯ ì‚¬ìš© (1ê°œ ì ˆì•½!)
}
```

**ê²€ì¦:**
```bash
forge inspect Inefficient storageLayout
forge inspect Optimized storageLayout
```
</details>

### ë¬¸ì œ 5: ì¤‘ì²© êµ¬ì¡°ì²´ ë¶„ì„

**íŒŒì¼:** `step02_exercises/StorageLayout.sol`

ë‹¤ìŒ êµ¬ì¡°ì²´ì˜ ìŠ¤í† ë¦¬ì§€ ë ˆì´ì•„ì›ƒì„ ë¶„ì„í•˜ì„¸ìš”:

```solidity
struct User {
    address addr;      // 20 bytes
    uint64 balance;   // 8 bytes
    uint64 timestamp; // 8 bytes
    bool active;       // 1 byte
}

contract Exercise5 {
    mapping(address => User) public users;
}
```

**ê³¼ì œ:**
1. `User` êµ¬ì¡°ì²´ê°€ ëª‡ ê°œì˜ ìŠ¬ë¡¯ì„ ì‚¬ìš©í•˜ëŠ”ì§€ ê³„ì‚°
2. `users[addr]`ì˜ ê° í•„ë“œê°€ ì–´ëŠ ìŠ¬ë¡¯ì— ì €ì¥ë˜ëŠ”ì§€ ê³„ì‚°
3. ì‹¤ì œë¡œ ê°’ì„ ì„¤ì •í•˜ê³  í™•ì¸

**íŒíŠ¸:**
- êµ¬ì¡°ì²´ëŠ” ì—°ì†ëœ ìŠ¬ë¡¯ì— ì €ì¥ë¨
- ë§¤í•‘ì˜ ê°’ì€ `keccak256(abi.encode(key, slot))` ìœ„ì¹˜ì— ì €ì¥
- êµ¬ì¡°ì²´ ë‚´ë¶€ í•„ë“œëŠ” ì—°ì†ì ìœ¼ë¡œ ì €ì¥ë¨

**ìì„¸í•œ ë¬¸ì œ ì„¤ëª…:** `step02_exercises/EXERCISES.md` íŒŒì¼ ì°¸ê³ 

---

## ğŸ› ï¸ ì‹¤ìŠµê³¼ì œ (Practice í´ë”)

### ê³¼ì œ 1: Storage Layout ì‹œê°í™”

**ëª©í‘œ:** `forge inspect`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì œ ìŠ¬ë¡¯ ë°°ì¹˜ í™•ì¸í•˜ê¸°

**ë‹¨ê³„:**
1. `step01_practice/` í´ë”ë¡œ ì´ë™
2. `StorageLayout.sol` íŒŒì¼ í™•ì¸
3. ì»´íŒŒì¼: `forge build`
4. Storage Layout í™•ì¸:
```bash
   forge inspect StorageLayout storageLayout
   ```
5. ì¶œë ¥ëœ í…Œì´ë¸”ì„ ë³´ë©°:
   - ê° ë³€ìˆ˜ê°€ ì–´ëŠ ìŠ¬ë¡¯ì— ì €ì¥ë˜ëŠ”ì§€ í™•ì¸
   - íŒ¨í‚¹ì´ ì–´ë–»ê²Œ ì´ë£¨ì–´ì§€ëŠ”ì§€ ê´€ì°°
   - Slot, Offset, Bytes ê°’ ì´í•´

**ì˜ˆìƒ ì¶œë ¥:**
```
| Name         | Type    | Slot | Offset | Bytes | Contract      |
|--------------|---------|------|--------|-------|---------------|
| a            | uint8   | 0    | 0      | 1     | StorageLayout |
| b            | uint16  | 0    | 1      | 2     | StorageLayout |
| c            | uint256 | 1    | 0      | 32    | StorageLayout |
| d            | uint64  | 0    | 3      | 8     | StorageLayout |
| e            | uint64  | 0    | 11     | 8     | StorageLayout |
| f            | uint128 | 2    | 0      | 16    | StorageLayout |
```

### ê³¼ì œ 2: ë³€ìˆ˜ íŒ¨í‚¹ ìµœì í™”

**ëª©í‘œ:** ê°€ìŠ¤ë¹„ë¥¼ ì ˆì•½í•˜ê¸° ìœ„í•´ ë³€ìˆ˜ ìˆœì„œ ìµœì í™”í•˜ê¸°

**ë¬¸ì œ ì»¨íŠ¸ë™íŠ¸:**
```solidity
contract Inefficient {
    uint256 a;  // 32 bytes - Slot 0
    uint8 b;    // 1 byte - Slot 1 (íŒ¨í‚¹ ì‹¤íŒ¨!)
    uint256 c;  // 32 bytes - Slot 2
    uint8 d;    // 1 byte - Slot 3 (íŒ¨í‚¹ ì‹¤íŒ¨!)
    // ì´ 4ê°œ ìŠ¬ë¡¯ ì‚¬ìš©
}
```

**ê³¼ì œ:**
1. ìœ„ ì»¨íŠ¸ë™íŠ¸ë¥¼ `StorageLayout.sol`ì— ì¶”ê°€
2. `forge inspect`ë¡œ ìŠ¬ë¡¯ ì‚¬ìš©ëŸ‰ í™•ì¸
3. ë³€ìˆ˜ ìˆœì„œë¥¼ ì¬ë°°ì¹˜í•˜ì—¬ ìŠ¬ë¡¯ ì‚¬ìš©ëŸ‰ ìµœì†Œí™”
4. ìµœì í™”ëœ ë²„ì „ ì‘ì„±:
   ```solidity
   contract Optimized {
    uint8 b;    // 1 byte
    uint8 d;    // 1 byte
       uint256 a;  // 32 bytes
       uint256 c;  // 32 bytes
       // ì´ 3ê°œ ìŠ¬ë¡¯ ì‚¬ìš© (1ê°œ ì ˆì•½!)
   }
   ```
5. ë‘ ë²„ì „ì˜ ìŠ¬ë¡¯ ì‚¬ìš©ëŸ‰ ë¹„êµ

**ê²€ì¦:**
```bash
forge inspect Inefficient storageLayout
forge inspect Optimized storageLayout
```

### ê³¼ì œ 3: Storage Reader í•¨ìˆ˜ êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸

**ëª©í‘œ:** Assemblyë¥¼ ì‚¬ìš©í•˜ì—¬ Storage ì§ì ‘ ì½ê¸°

**ì´ë¯¸ êµ¬í˜„ëœ í•¨ìˆ˜ë“¤:**
- `readSlot(uint256 slot)`: íŠ¹ì • ìŠ¬ë¡¯ì˜ ê°’ ì½ê¸°
- `readArraySlot(uint256 arraySlot, uint256 index)`: ë™ì  ë°°ì—´ ìŠ¬ë¡¯ ê³„ì‚°
- `readMappingSlot(uint256 mappingSlot, address key)`: ë§¤í•‘ ìŠ¬ë¡¯ ê³„ì‚°

**ê³¼ì œ:**
1. `StorageLayout.t.sol` íŒŒì¼ ì—´ê¸°
2. `test_VariablePacking()` í•¨ìˆ˜ì˜ TODO ë¶€ë¶„ ì™„ì„±:
```solidity
   function test_VariablePacking() public {
       storageLayout.set_a(1);
       storageLayout.set_b(2);
       storageLayout.set_c(3);
       
       // ìŠ¬ë¡¯ ì½ê¸° í…ŒìŠ¤íŠ¸
       bytes32 slot0 = storageLayout.readSlot(0);
       bytes32 slot1 = storageLayout.readSlot(1);
       
       // TODO: slot0ì—ì„œ aì™€ b ê°’ ì¶”ì¶œí•˜ì—¬ ê²€ì¦
       // íŒíŠ¸: íŒ¨í‚¹ëœ ê°’ì„ bit ì—°ì‚°ìœ¼ë¡œ ë¶„ë¦¬
   }
   ```

3. `test_DynamicArraySlot()` í•¨ìˆ˜ ì™„ì„±:
   - ë™ì  ë°°ì—´ì— ê°’ ì„¤ì •
   - `readArraySlot()`ìœ¼ë¡œ ìŠ¬ë¡¯ ê³„ì‚°
   - ê³„ì‚°ëœ ìŠ¬ë¡¯ì—ì„œ ê°’ ì½ì–´ì„œ ê²€ì¦

4. `test_MappingSlot()` í•¨ìˆ˜ ì™„ì„±:
   - ë§¤í•‘ì— ê°’ ì„¤ì •
   - `readMappingSlot()`ìœ¼ë¡œ ìŠ¬ë¡¯ ê³„ì‚°
   - ê³„ì‚°ëœ ìŠ¬ë¡¯ì—ì„œ ê°’ ì½ì–´ì„œ ê²€ì¦

5. í…ŒìŠ¤íŠ¸ ì‹¤í–‰:
   ```bash
   forge test -vv
   ```

**ì°¸ê³  ì½”ë“œ:**
```solidity
// íŒ¨í‚¹ëœ ê°’ì—ì„œ íŠ¹ì • ë°”ì´íŠ¸ ì¶”ì¶œ
function extractUint8(bytes32 slot, uint256 offset) pure returns (uint8) {
    return uint8(uint256(slot) >> (offset * 8));
}
```

---

## âœ… ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸

ëª¨ë“  í•™ìŠµì„ ì™„ë£Œí•œ í›„ ì•„ë˜ í•­ëª©ë“¤ì„ í™•ì¸í•˜ì„¸ìš”:

### ì´ë¡  ì´í•´
- [ ] EVM ìŠ¤í† ë¦¬ì§€ê°€ 2^256ê°œì˜ 32ë°”ì´íŠ¸ ìŠ¬ë¡¯ìœ¼ë¡œ êµ¬ì„±ë¨ì„ ì´í•´í–ˆë‹¤
- [ ] ë³€ìˆ˜ íŒ¨í‚¹ ê·œì¹™ 3ê°€ì§€ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
- [ ] ë™ì  ë°°ì—´ì˜ ìŠ¬ë¡¯ ê³„ì‚° ê³µì‹ `keccak256(slot) + index`ë¥¼ ì™¸ì› ë‹¤
- [ ] ë§¤í•‘ì˜ ìŠ¬ë¡¯ ê³„ì‚° ê³µì‹ `keccak256(abi.encode(key, slot))`ì„ ì™¸ì› ë‹¤
- [ ] keccak256 í•´ì‹œ í•¨ìˆ˜ì˜ íŠ¹ì§•(ë‹¨ë°©í–¥, ê²°ì •ì , ëˆˆì‚¬íƒœ íš¨ê³¼)ì„ ì´í•´í–ˆë‹¤

### ì‹¤ìŠµ ì™„ë£Œ
- [ ] `step01_practice/` í´ë”ì—ì„œ `forge inspect`ë¡œ ì‹¤ì œ ìŠ¬ë¡¯ ë°°ì¹˜ë¥¼ í™•ì¸í•´ë´¤ë‹¤
- [ ] `readSlot()` í•¨ìˆ˜ë¡œ ìŠ¬ë¡¯ ê°’ì„ ì§ì ‘ ì½ì–´ë´¤ë‹¤
- [ ] `readArraySlot()` í•¨ìˆ˜ë¡œ ë™ì  ë°°ì—´ ìŠ¬ë¡¯ì„ ê³„ì‚°í•´ë´¤ë‹¤
- [ ] `readMappingSlot()` í•¨ìˆ˜ë¡œ ë§¤í•‘ ìŠ¬ë¡¯ì„ ê³„ì‚°í•´ë´¤ë‹¤
- [ ] í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•´ë´¤ë‹¤

### ì—°ìŠµë¬¸ì œ ì™„ë£Œ
- [ ] ë¬¸ì œ 1: ê¸°ë³¸ ìŠ¬ë¡¯ ê³„ì‚° ì™„ë£Œ
- [ ] ë¬¸ì œ 2: ë™ì  ë°°ì—´ ìŠ¬ë¡¯ ê³„ì‚° ì™„ë£Œ
- [ ] ë¬¸ì œ 3: ë§¤í•‘ ìŠ¬ë¡¯ ê³„ì‚° ì™„ë£Œ
- [ ] ë¬¸ì œ 4: ë³€ìˆ˜ íŒ¨í‚¹ ìµœì í™” ì™„ë£Œ
- [ ] ë¬¸ì œ 5: ì¤‘ì²© êµ¬ì¡°ì²´ ë¶„ì„ ì™„ë£Œ

### ì‹¬í™” í•™ìŠµ
- [ ] Assemblyë¥¼ ì‚¬ìš©í•œ Storage ì§ì ‘ ì ‘ê·¼ ë°©ë²•ì„ ì´í•´í–ˆë‹¤
- [ ] ë©´ì ‘ ëŒ€ë¹„ ì§ˆë¬¸ì— ë‹µë³€í•  ìˆ˜ ìˆë‹¤

---

## ğŸ¯ ë©´ì ‘ ëŒ€ë¹„ ì§ˆë¬¸

1. **Q: `uint128` ë‘ ê°œë¥¼ ì„ ì–¸í•˜ë©´ ëª‡ ê°œì˜ ìŠ¬ë¡¯ì„ ì‚¬ìš©í•˜ë‚˜ìš”?**
   - A: 1ê°œì˜ ìŠ¬ë¡¯ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ê°ê° 16ë°”ì´íŠ¸ì´ë¯€ë¡œ 32ë°”ì´íŠ¸ ìŠ¬ë¡¯ì— í•¨ê»˜ ë“¤ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2. **Q: ë™ì  ë°°ì—´ê³¼ ë§¤í•‘ì˜ ì°¨ì´ì ì€?**
   - A: ë™ì  ë°°ì—´ì€ ê¸¸ì´ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ìŠ¬ë¡¯ì´ í•„ìš”í•˜ì§€ë§Œ, ë§¤í•‘ì€ ê¸¸ì´ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë§¤í•‘ì€ í‚¤-ê°’ ìŒë§Œ ì €ì¥í•©ë‹ˆë‹¤.

3. **Q: ë³€ìˆ˜ íŒ¨í‚¹ì´ ì‹¤íŒ¨í•˜ëŠ” ê²½ìš°ëŠ”?**
   - A: ë‹¤ìŒ ë³€ìˆ˜ê°€ 32ë°”ì´íŠ¸ë³´ë‹¤ í¬ê±°ë‚˜, í˜„ì¬ ìŠ¬ë¡¯ì˜ ë‚¨ì€ ê³µê°„ë³´ë‹¤ í´ ë•Œ ì‹¤íŒ¨í•©ë‹ˆë‹¤.

---

## ğŸ’» Assemblyë¥¼ ì‚¬ìš©í•œ Storage ì§ì ‘ ì ‘ê·¼

ì„¤ëª…ë“œë¦° `slot[p]`, `T`, `p`, `keccak256(p)` ê°™ì€ í‘œí˜„ì€ **ê°œë°œìê°€ ì´í•´í•˜ê¸° ì‰½ê²Œ ë§Œë“  "ì¶”ìƒì ì¸ ê³µì‹"**ì´ë©°, ì¼ë°˜ì ì¸ Solidity ì½”ë“œ(`Counter.sol` ë“±)ì—ì„œëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ, **"Assembly(ì–´ì…ˆë¸”ë¦¬)"**ë¼ê³  ë¶ˆë¦¬ëŠ” íŠ¹ìˆ˜í•œ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì´ ê³µì‹ëŒ€ë¡œ **ì‹¤ì œ ìŠ¬ë¡¯ì— ì§ì ‘ ì ‘ê·¼**í•˜ì—¬ ê°’ì„ ì½ê±°ë‚˜ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 1. ì¼ë°˜ Solidity ì½”ë“œì—ì„œëŠ”? (ì‚¬ìš© ë¶ˆê°€)

ìš°ë¦¬ê°€ í‰ì†Œì— ì“°ëŠ” ì½”ë“œ(`Counter.sol`)ì—ì„œëŠ” ì´ëŸ° í‘œí˜„ì„ ì“°ì§€ ì•ŠìŠµë‹ˆë‹¤.
Solidityê°€ ì•Œì•„ì„œ ì´ ê³µì‹ì„ ë‚´ë¶€ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì£¼ê¸° ë•Œë¬¸ì—, ìš°ë¦¬ëŠ” ê·¸ëƒ¥ **ë³€ìˆ˜ ì´ë¦„**ë§Œ ì“°ë©´ ë©ë‹ˆë‹¤.

```solidity
// ì¼ë°˜ì ì¸ Solidity ì‚¬ìš©ë²•
uint256[] public arr;

function example() public {
    arr.push(100);      // ê·¸ëƒ¥ pushí•˜ë©´ ì•Œì•„ì„œ ìŠ¬ë¡¯ ê³„ì‚°í•´ì„œ ë„£ìŒ
    uint256 x = arr[0]; // ê·¸ëƒ¥ ì¸ë±ìŠ¤ë¡œ ì ‘ê·¼í•˜ë©´ ì•Œì•„ì„œ ê°€ì ¸ì˜´
}
```

### 2. "Assembly"ë¥¼ ì“°ë©´? (ì‚¬ìš© ê°€ëŠ¥)

`slot`, `p` ê°™ì€ ê°œë…ì„ ì‹¤ì œë¡œ ì½”ë“œì—ì„œ ì“°ê³  ì‹¶ë‹¤ë©´ `assembly { ... }` ë¸”ë¡ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë•ŒëŠ” `T`, `p` ëŒ€ì‹  ì‹¤ì œ ë³€ìˆ˜ì˜ ìŠ¬ë¡¯ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ë²•(`.slot`)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, `arr`ì˜ ê¸¸ì´ë¥¼ ì§ì ‘ ìŠ¬ë¡¯ì—ì„œ ì½ì–´ì˜¤ëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```solidity
uint256[] public arr;

function getLengthFromSlot() public view returns (uint256 length) {
    assembly {
        // arr.slot : arr ë³€ìˆ˜ê°€ ì‹œì‘ë˜ëŠ” ìŠ¬ë¡¯ ë²ˆí˜¸ (ê³µì‹ì—ì„œì˜ 'p')
        // sload(p) : pë²ˆ ìŠ¬ë¡¯ì˜ ê°’ì„ ì½ì–´ì™€ë¼ (ê³µì‹ì—ì„œì˜ 'slot[p]')
        length := sload(arr.slot)
    }
}
```

- `arr.slot`: ì—¬ê¸°ì„œ `p`ì— í•´ë‹¹í•˜ëŠ” ì‹¤ì œ ìŠ¬ë¡¯ ë²ˆí˜¸ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
- `sload()`: íŠ¹ì • ìŠ¬ë¡¯ì˜ ë°ì´í„°ë¥¼ ì½ëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤.

### 3. ì‹¤ì œ ë°ì´í„° ìœ„ì¹˜ ê³„ì‚°í•´ë³´ê¸° (ì‹¬í™”)

ê³µì‹ì—ì„œ ë³¸ `keccak256(p)` ìœ„ì¹˜ì— ìˆëŠ” ì‹¤ì œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

```solidity
function getFirstElementFromSlot() public view returns (uint256 element) {
    assembly {
        // 1. p (ìŠ¬ë¡¯ ë²ˆí˜¸) ê°€ì ¸ì˜¤ê¸°
        let p := arr.slot
        
        // 2. keccak256(p) ê³„ì‚°í•˜ê¸°
        // ë©”ëª¨ë¦¬ 0ë²ˆì§€ì— pê°’ì„ ì €ì¥í•˜ê³  í•´ì‹œë¥¼ ëŒë¦¼ (ë³µì¡í•œ ê³¼ì • í•„ìš”)
        mstore(0, p)
        let dataSlot := keccak256(0, 32) 
        
        // 3. ê³„ì‚°ëœ ìœ„ì¹˜ì—ì„œ ë°ì´í„° ì½ê¸°
        element := sload(dataSlot)
    }
}
```

### ìš”ì•½

1. **ì„¤ëª…ì— ì“´ í‘œí˜„(`slot[p]`, `T` ë“±):** ì´í•´ë¥¼ ë•ê¸° ìœ„í•œ **ìˆ˜í•™ ê³µì‹** ê°™ì€ ê²ƒì…ë‹ˆë‹¤. ì½”ë“œì— ê·¸ëŒ€ë¡œ ë³µì‚¬í•˜ë©´ ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤.
2. **ì¼ë°˜ ì½”ë”©:** ê·¸ëƒ¥ `arr.length`, `arr[0]`ì²˜ëŸ¼ í¸í•˜ê²Œ ì“°ì‹œë©´ ë©ë‹ˆë‹¤. Solidityê°€ ì•Œì•„ì„œ ê³µì‹ì„ ì ìš©í•´ ì¤ë‹ˆë‹¤.
3. **ê³ ê¸‰ ì½”ë”©(Assembly):** `.slot`, `sload` ê°™ì€ íŠ¹ìˆ˜ ëª…ë ¹ì–´ë¥¼ ì“°ë©´ ê³µì‹ê³¼ ë˜‘ê°™ì´ ì‘ë™í•˜ë„ë¡ **ì§ì ‘ ì¡°ì‘**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì§ˆë¬¸í•˜ì‹  ë‚´ìš©ì˜ í•µì‹¬ì€ **"ì´ê±´ Solidityê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì´ë ‡ê²Œ ì‘ë™í•œë‹¤ëŠ” ì„¤ê³„ë„"**ì´ë©°, ì‹¤ì œ ì½”ë”©í•  ë•ŒëŠ” **ìë™ìœ¼ë¡œ ì²˜ë¦¬ëœë‹¤**ëŠ” ì ì…ë‹ˆë‹¤.

---

## ğŸ” keccak256 í•´ì‹œ í•¨ìˆ˜

`keccak256`ì€ ì´ë”ë¦¬ì›€ ë¸”ë¡ì²´ì¸ì—ì„œ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” **ì•”í˜¸í™” í•´ì‹œ í•¨ìˆ˜**ì…ë‹ˆë‹¤.

ì‰½ê²Œ ë¹„ìœ í•˜ë©´ **"ë§ˆë²•ì˜ ë¶„ì‡„ê¸°"**ì™€ ê°™ìŠµë‹ˆë‹¤. ì–´ë–¤ ì¬ë£Œ(ë°ì´í„°)ë¥¼ ë„£ë“ ì§€ ê°„ì—, í•­ìƒ **ì¼ì •í•œ í¬ê¸°(32ë°”ì´íŠ¸)**ì˜ **ì•Œì•„ë³¼ ìˆ˜ ì—†ëŠ” ê°€ë£¨(í•´ì‹œê°’)**ë¡œ ê°ˆì•„ë²„ë¦½ë‹ˆë‹¤.

### í•µì‹¬ ê¸°ëŠ¥ê³¼ íŠ¹ì§•

1. **ê³ ìœ í•œ ì§€ë¬¸ ìƒì„± (Deterministic)**
   - ê°™ì€ ë°ì´í„°ë¥¼ ë„£ìœ¼ë©´ í•­ìƒ **ë˜‘ê°™ì€ ê²°ê³¼**ê°€ ë‚˜ì˜µë‹ˆë‹¤.
   - ì…ë ¥ ë°ì´í„°ê°€ ê¸€ì í•˜ë‚˜ë§Œ ë‹¬ë¼ì ¸ë„ ê²°ê³¼ëŠ” **ì™„ì „íˆ ë‹¤ë¥´ê²Œ** ë°”ë€ë‹ˆë‹¤(ëˆˆì‚¬íƒœ íš¨ê³¼).
   - *ì˜ˆ: `keccak256("apple")`ê³¼ `keccak256("apple!")`ì˜ ê²°ê³¼ëŠ” ì²œì§€ ì°¨ì´ì…ë‹ˆë‹¤.*

2. **ë˜ëŒë¦¬ê¸° ë¶ˆê°€ëŠ¥ (One-way)**
   - ê°ˆì•„ë²„ë¦° ê°€ë£¨(í•´ì‹œê°’)ë§Œ ë³´ê³  ì›ë˜ ì¬ë£Œ(ì…ë ¥ê°’)ê°€ ë¬´ì—‡ì´ì—ˆëŠ”ì§€ ì¶”ì¸¡í•˜ëŠ” ê²ƒì€ **ë¶ˆê°€ëŠ¥**í•©ë‹ˆë‹¤.
   - ì´ íŠ¹ì„± ë•ë¶„ì— ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ì´ë‚˜ ë°ì´í„° ë¬´ì¡°ì‘ ì¦ëª…ì— ì“°ì…ë‹ˆë‹¤.

3. **ë°ì´í„° ìœ„ì¹˜ ê³„ì‚° (ì£¼ì†Œ ìƒì„±ê¸°)**
   - ì•„ê¹Œ ì„¤ëª…ë“œë¦° `mapping`ì´ë‚˜ `ë™ì  ë°°ì—´`ì—ì„œ **ë°ì´í„°ê°€ ì €ì¥ë  ìŠ¬ë¡¯ ìœ„ì¹˜ë¥¼ ì •í•  ë•Œ** ì´ í•¨ìˆ˜ë¥¼ ì”ë‹ˆë‹¤.
   - ë§ˆì¹˜ "ì² ìˆ˜ì˜ ë°ì´í„°ëŠ” ì–´ë””ì— ë‘˜ê¹Œìš”?"ë¼ê³  ë¬¼ìœ¼ë©´, `keccak256("ì² ìˆ˜")`ë¥¼ ëŒë ¤ì„œ "38492ë²ˆ ì‚¬ë¬¼í•¨ì— ë„£ì–´!"ë¼ê³  ë¬´ì‘ìœ„ì²˜ëŸ¼ ë³´ì´ëŠ”(í•˜ì§€ë§Œ ì •í•´ì§„) ìœ„ì¹˜ë¥¼ ì•Œë ¤ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

### ì›ë³¸ì„ ìƒì–´ë²„ë¦¬ë©´?

`keccak256`ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì•”í˜¸í™”(ì •í™•íˆëŠ” **í•´ì‹±**)í•œ ë’¤ ì›ë³¸ì„ ìƒì–´ë²„ë¦¬ë©´, ê·¸ ë°ì´í„°ëŠ” **ì˜ì›íˆ ì‚¬ìš©í•  ìˆ˜ ì—†ê²Œ ë˜ì–´ "ë””ì§€í„¸ ì“°ë ˆê¸°"**ê°€ ë©ë‹ˆë‹¤.

ì›ë³¸ì„ ëª¨ë¥¼ ë•Œ ë°œìƒí•˜ëŠ” êµ¬ì²´ì ì¸ ìƒí™© 3ê°€ì§€:

#### 1. ìì‚° ì˜êµ¬ ë™ê²° (ê°€ì¥ í”í•œ ì‚¬ê³ )
ë§Œì•½ **ê°œì¸í‚¤(Private Key)**ë¥¼ ìƒì–´ë²„ë¦¬ê³  í•´ì‹œê°’(ì§€ê°‘ ì£¼ì†Œ)ë§Œ ì•Œê³  ìˆë‹¤ë©´?
- **ìƒí™©:** ë‚´ ì§€ê°‘ì— 100ì–µ ì›ì–´ì¹˜ ë¹„íŠ¸ì½”ì¸ì´ ë“¤ì–´ìˆëŠ” ê²ƒì€ ë¸”ë¡ì²´ì¸ ìƒì—ì„œ ë»”íˆ ë³´ì…ë‹ˆë‹¤.
- **ë¬¸ì œ:** ê·¸ ëˆì„ êº¼ë‚´ë ¤ë©´ "ë‚´ê°€ ì´ ì£¼ì†Œ(í•´ì‹œê°’)ì˜ ì£¼ì¸(ì›ë³¸ í‚¤ ì†Œìœ ì)ì´ë‹¤!"ë¼ëŠ” ê²ƒì„ ì¦ëª…í•´ì•¼ í•˜ëŠ”ë°, ì¦ëª…í•  ì›ë³¸ í‚¤ê°€ ì—†ìŠµë‹ˆë‹¤.
- **ê²°ê³¼:** ê·¸ ëˆì€ **ëˆ„êµ¬ë„ êº¼ë‚¼ ìˆ˜ ì—†ëŠ” ìƒíƒœ**ë¡œ ì˜ì›íˆ ë¸”ë¡ì²´ì¸ì— ê°‡í™ë‹ˆë‹¤.

#### 2. ë¡œê·¸ì¸ ë¶ˆê°€ ë° ë°ì´í„° ì ‘ê·¼ ì°¨ë‹¨
ë¹„ë°€ë²ˆí˜¸ë¥¼ í•´ì‹œê°’ìœ¼ë¡œ ì €ì¥í•´ë‘” ì‹œìŠ¤í…œì—ì„œ ì›ë³¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠì–´ë²„ë ¸ë‹¤ë©´?
- **ìƒí™©:** ì„œë²„ì—ëŠ” `keccak256("ë‚´ë¹„ë°€ë²ˆí˜¸123")`ì˜ ê²°ê³¼ì¸ `0xab12...`ë§Œ ì €ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
- **ë¬¸ì œ:** ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ì„ ì‹œë„í•  ë•Œ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë˜‘ê°™ì´ í•´ì‹±í•´ì„œ ë¹„êµí•´ì•¼ í•˜ëŠ”ë°, ì‚¬ìš©ìê°€ ì›ë³¸ì„ ëª¨ë¦…ë‹ˆë‹¤.
- **ê²°ê³¼:** ì„œë²„ ê´€ë¦¬ìì¡°ì°¨ ì›ë³¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë¥´ê¸° ë•Œë¬¸ì—, **ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°ê°€ ë¶ˆê°€ëŠ¥**í•˜ê³  ì˜¤ì§ **ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •**ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤. (ë§Œì•½ ì¬ì„¤ì • ê¸°ëŠ¥ì´ ì—†ë‹¤ë©´ ê³„ì •ì€ ì˜êµ¬ ë´‰ì¸ë©ë‹ˆë‹¤.)

#### 3. ê²€ì¦ ì‹¤íŒ¨ (ë¬´ê²°ì„± ê¹¨ì§)
ì¤‘ìš”í•œ ë¬¸ì„œ(ê³„ì•½ì„œ ë“±)ì˜ ì›ë³¸ì„ ìƒì–´ë²„ë¦¬ê³  í•´ì‹œê°’(ì§€ë¬¸)ë§Œ ê°€ì§€ê³  ìˆë‹¤ë©´?
- **ìƒí™©:** "ì´ ë¬¸ì„œì˜ í•´ì‹œê°’ì€ `0x1234...`ì…ë‹ˆë‹¤"ë¼ëŠ” ê¸°ë¡ì€ ë‚¨ì•„ìˆìŠµë‹ˆë‹¤.
- **ë¬¸ì œ:** ë‚˜ì¤‘ì— ëˆ„êµ°ê°€ ìœ„ì¡°ëœ ë¬¸ì„œë¥¼ ë“¤ê³  ì™€ë„, "ì´ê²Œ ì›ë³¸ì´ ë§ë‹¤/ì•„ë‹ˆë‹¤"ë¥¼ íŒë³„í•  **ë¹„êµ ëŒ€ìƒ(ì§„ì§œ ì›ë³¸)**ì´ ì—†ìŠµë‹ˆë‹¤.
- **ê²°ê³¼:** ë²•ì  íš¨ë ¥ì´ë‚˜ ì¦ëª… ëŠ¥ë ¥ì„ ìƒê²Œ ë©ë‹ˆë‹¤.

### ìš”ì•½: ì–¸ì œ ì“°ì´ë‚˜ìš”?

1. **ì„œëª… ë§Œë“¤ê¸°:** "ì´ ê±°ë˜ëŠ” ë‚´ê°€ ë³´ë‚¸ ê²Œ í™•ì‹¤í•´!"ë¼ê³  ì¦ëª…í•  ë•Œ.
2. **ID ë§Œë“¤ê¸°:** ìœ ë‹ˆí¬í•œ IDê°€ í•„ìš”í•  ë•Œ (ì˜ˆ: NFT ID ìƒì„±).
3. **ìœ„ì¹˜ ì°¾ê¸°:** ë¸”ë¡ì²´ì¸ ì €ì¥ì†Œ(Storage)ì˜ ëª‡ ë²ˆì§¸ ì¹¸ì— ë°ì´í„°ë¥¼ ì €ì¥í• ì§€ ê²°ì •í•  ë•Œ.

ì¦‰, ì´ë”ë¦¬ì›€ ì„¸ê³„ì—ì„œ **"ë¬´ì–¸ê°€ë¥¼ ìœ ì¼í•˜ê²Œ ì‹ë³„í•˜ê±°ë‚˜, ë³´ì•ˆì´ í•„ìš”í•œ ê³³ì— ìˆ¨ê²¨ë‘ê³  ì‹¶ì„ ë•Œ"** ì‚¬ìš©í•˜ëŠ” í•„ìˆ˜ ë„êµ¬ì…ë‹ˆë‹¤.

---

## ğŸ’¼ keccak256 ì‹¤ì œ ì‚¬ìš© ì‚¬ë¡€

ìŠ¤ë§ˆíŠ¸ ì»¨íŠ¸ë™íŠ¸ì—ì„œ `keccak256`ì´ ì‹¤ì œë¡œ ì“°ì´ëŠ” ëŒ€í‘œì ì¸ 3ê°€ì§€ ì‚¬ë¡€(ê¶Œí•œ ê´€ë¦¬, ê³ ìœ  ID ìƒì„±, ì„œëª… ê²€ì¦)ë¥¼ ì½”ë“œë¡œ ë³´ì—¬ë“œë¦´ê²Œìš”.

### 1. ì—­í•  ê¸°ë°˜ ê¶Œí•œ ê´€ë¦¬ (Role-Based Access Control)

ê°€ì¥ í”í•˜ê²Œ ì“°ì´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. "ê´€ë¦¬ì", "ë¯¼í„°(ë°œí–‰ì)" ê°™ì€ ì—­í•  ì´ë¦„ì„ `keccak256`ìœ¼ë¡œ í•´ì‹œí™”í•˜ì—¬ ê³ ìœ í•œ ID(bytes32)ë¡œ ë§Œë“­ë‹ˆë‹¤. ë¬¸ìì—´ì„ ê·¸ëŒ€ë¡œ ë¹„êµí•˜ëŠ” ê²ƒë³´ë‹¤ ê°€ìŠ¤ë¹„ê°€ í›¨ì”¬ ì ˆì•½ë©ë‹ˆë‹¤.

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract RoleManager {
    // "ADMIN_ROLE"ì´ë¼ëŠ” ê¸€ìë¥¼ í•´ì‹œê°’ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥ (ê³ ìœ  ID ì—­í• )
    // ì˜ˆ: 0xdf8b4c520ffe197c5343c6f5...
    bytes32 public constant ADMIN_ROLE = keccak256("ADMIN_ROLE");
    bytes32 public constant MINTER_ROLE = keccak256("MINTER_ROLE");

    mapping(bytes32 => mapping(address => bool)) public roles;

    constructor() {
        // ë°°í¬í•œ ì‚¬ëŒì—ê²Œ ADMIN ê¶Œí•œ ë¶€ì—¬
        roles[ADMIN_ROLE][msg.sender] = true;
    }

    function grantMinter(address _user) external {
        // í˜¸ì¶œìê°€ ADMIN ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸
        require(roles[ADMIN_ROLE][msg.sender], "Not Admin");
        roles[MINTER_ROLE][_user] = true;
    }
}
```

**ë¹„ìœ :** ì´ ì½”ë“œëŠ” **"ë†€ì´ê³µì› ììœ ì´ìš©ê¶Œ ê²€ì‚¬"**ì™€ ë¹„ìŠ·í•©ë‹ˆë‹¤.
- **`ADMIN_ROLE` (ê´€ë¦¬ì ë°°ì§€):** "ADMIN_ROLE"ì´ë¼ëŠ” ê¸€ìë¥¼ ì•”í˜¸í™”í•´ì„œ ì•„ë¬´ë„ ìœ„ì¡°í•  ìˆ˜ ì—†ëŠ” **íŠ¹ë³„í•œ ë„ì¥(bytes32)**ì„ ë§Œë“­ë‹ˆë‹¤. ì´ ë„ì¥ì€ ê´€ë¦¬ìë§Œ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **`constructor` (ê°œì¥ ì¤€ë¹„):** ë†€ì´ê³µì›ì„ ì²˜ìŒ ë§Œë“  ì‚¬ëŒ(ë°°í¬ì, `msg.sender`) ì†ë“±ì— ì´ **ê´€ë¦¬ì ë„ì¥**ì„ ê½ ì°ì–´ì¤ë‹ˆë‹¤ (`roles[ADMIN][ë‚˜] = true`).
- **`grantMinter` (ì•Œë°”ìƒ ì±„ìš©):**
  1. ëˆ„êµ°ê°€ "ì € ì•Œë°” ì‹œì¼œì£¼ì„¸ìš”(`grantMinter` í˜¸ì¶œ)" í•˜ê³  ì°¾ì•„ì˜µë‹ˆë‹¤.
  2. ë¨¼ì € "ë„ˆ ì†ë“± ë³´ì—¬ë´. ê´€ë¦¬ì ë„ì¥ ìˆì–´?" í•˜ê³  í™•ì¸í•©ë‹ˆë‹¤ (`require`).
  3. ë„ì¥ì´ ìˆìœ¼ë©´, ê·¸ ì‚¬ëŒì—ê²Œ **ë¯¼í„°(ë°œí–‰ì) ë„ì¥**ì„ ìƒˆë¡œ ì°ì–´ì¤ë‹ˆë‹¤. ë„ì¥ì´ ì—†ìœ¼ë©´ "ë„Œ ê´€ë¦¬ìê°€ ì•„ë‹ˆì–ì•„!" í•˜ê³  ì«“ì•„ëƒ…ë‹ˆë‹¤.

**í•µì‹¬:** ê¸´ ì´ë¦„("ADMIN_ROLE") ëŒ€ì‹  **ì•”í˜¸í™”ëœ ë„ì¥(í•´ì‹œê°’)**ì„ ì¨ì„œ ë¹ ë¥´ê³  ì •í™•í•˜ê²Œ ì‹ ë¶„ì„ í™•ì¸í•©ë‹ˆë‹¤.

### 2. ê³ ìœ  ID ìƒì„± (Unique Identifier)

ì—¬ëŸ¬ ì •ë³´(ì˜ˆ: ì‚¬ìš©ì ì£¼ì†Œ + í˜„ì¬ ì‹œê°„ + ID)ë¥¼ ì„ì–´ì„œ, ì ˆëŒ€ ê²¹ì¹˜ì§€ ì•ŠëŠ” ìœ ë‹ˆí¬í•œ IDë¥¼ ë§Œë“¤ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract UniqueIDGenerator {
    struct Item {
        bytes32 id;
        string name;
    }
    
    Item[] public items;

    function createItem(string memory _name) public returns (bytes32) {
        // ì´ë¦„ + ìƒì„±ì ì£¼ì†Œ + í˜„ì¬ ì‹œê°„(block.timestamp)ì„ ì„ì–´ì„œ í•´ì‹œ ìƒì„±
        // abi.encodePackedëŠ” ì—¬ëŸ¬ ì¸ìë¥¼ í•˜ë‚˜ë¡œ ë­‰ì³ì£¼ëŠ” í•¨ìˆ˜
        bytes32 uniqueId = keccak256(abi.encodePacked(_name, msg.sender, block.timestamp));
        
        items.push(Item(uniqueId, _name));
        return uniqueId;
    }
}
```

**ë¹„ìœ :** ì´ ì½”ë“œëŠ” **"ì ˆëŒ€ ê²¹ì¹˜ì§€ ì•ŠëŠ” ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ë§Œë“¤ê¸°"**ì…ë‹ˆë‹¤.
- **ì¬ë£Œ ì¤€ë¹„:** ì£¼ë¯¼ë²ˆí˜¸ë¥¼ ë§Œë“¤ ë•Œ ë‹¤ìŒ ì„¸ ê°€ì§€ë¥¼ ì„ìŠµë‹ˆë‹¤.
  1. **ì´ë¦„:** "ì² ìˆ˜" (`_name`)
  2. **ë§Œë“  ì‚¬ëŒ:** "ë™ì‚¬ë¬´ì†Œ ì§ì› A" (`msg.sender`)
  3. **ë§Œë“  ì‹œê°„:** "2026ë…„ 1ì›” 5ì¼ 4ì‹œ 1ë¶„ 1ì´ˆ" (`block.timestamp`)
- **`abi.encodePacked` (ë¯¹ì„œê¸° í†µì— ë„£ê¸°):** ì´ ì„¸ ê°€ì§€ ì¬ë£Œë¥¼ ë¯¹ì„œê¸°ì— ë„£ê¸° ì¢‹ê²Œ í•œ ë©ì–´ë¦¬ë¡œ ê½‰ê½‰ ë­‰ì¹©ë‹ˆë‹¤.
- **`keccak256` (ë¯¹ì„œê¸° ëŒë¦¬ê¸°):** ìœ™~ ê°ˆì•„ì„œ **ì•Œì•„ë³¼ ìˆ˜ ì—†ëŠ” ê°€ë£¨(í•´ì‹œê°’)**ë¡œ ë§Œë“­ë‹ˆë‹¤.
- **ê²°ê³¼:** ì„¸ìƒì— ë‹¨ í•˜ë‚˜ë¿ì¸ IDê°€ ì™„ì„±ë©ë‹ˆë‹¤.
  - ê°™ì€ "ì² ìˆ˜"ë¼ë„ **ë§Œë“  ì‚¬ëŒ**ì´ ë‹¤ë¥´ê±°ë‚˜ **ë§Œë“  ì‹œê°„**ì´ 0.1ì´ˆë¼ë„ ë‹¤ë¥´ë©´, ì™„ì „íˆ ë‹¤ë¥¸ IDê°€ ë‚˜ì˜µë‹ˆë‹¤. ê·¸ë˜ì„œ ì ˆëŒ€ ê²¹ì¹  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.

### 3. ì„œëª… ê²€ì¦ (Signature Verification)

ì‚¬ìš©ìê°€ "ë‚´ê°€ ì´ ê±°ë˜ë¥¼ ìŠ¹ì¸í–ˆì–´"ë¼ê³  ì„œëª…(Signature)ì„ ë³´ë‚´ë©´, ì»¨íŠ¸ë™íŠ¸ê°€ ê·¸ ì„œëª…ì´ ì§„ì§œì¸ì§€ í™•ì¸í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ë•Œ ì„œëª…ëœ ë©”ì‹œì§€ì˜ ì›ë³¸ì„ í•´ì‹œí™”í•´ì„œ ë¹„êµí•©ë‹ˆë‹¤.

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract VerifySignature {
    /* 
    ì„œëª… ê²€ì¦ ê³¼ì •:
    1. ë©”ì‹œì§€(ë¬¸ìì—´)ë¥¼ í•´ì‹œí™”í•œë‹¤.
    2. ì´ë”ë¦¬ì›€ ì„œëª… í‘œì¤€(Prefix ì¶”ê°€)ì— ë§ì¶° ë‹¤ì‹œ í•´ì‹œí™”í•œë‹¤.
    3. ecrecover í•¨ìˆ˜ë¡œ ì„œëª…ì—ì„œ ì£¼ì†Œë¥¼ ë³µì›í•˜ì—¬, ë³´ë‚¸ ì‚¬ëŒê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.
    */
    function verify(
        address _signer,
        string memory _message,
        bytes memory _signature
    ) public pure returns (bool) {
        // 1. ë©”ì‹œì§€ í•´ì‹œ ìƒì„±
        bytes32 messageHash = keccak256(abi.encodePacked(_message));
        
        // 2. ì´ë”ë¦¬ì›€ ì„œëª…ëœ ë©”ì‹œì§€ í•´ì‹œë¡œ ë³€í™˜
        bytes32 ethSignedMessageHash = getEthSignedMessageHash(messageHash);
        
        // 3. ì„œëª… ë³µì› (recover í•¨ìˆ˜ëŠ” ë³„ë„ êµ¬í˜„ í•„ìš”, ì—¬ê¸°ì„  ê°œë…ë§Œ ì„¤ëª…)
        return recoverSigner(ethSignedMessageHash, _signature) == _signer;
    }

    function getEthSignedMessageHash(bytes32 _messageHash) public pure returns (bytes32) {
        return keccak256(
            abi.encodePacked("\x19Ethereum Signed Message:\n32", _messageHash)
        );
    }
    
    // (ì°¸ê³ ) recoverSignerëŠ” ecrecoverë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•©ë‹ˆë‹¤.
    function recoverSigner(bytes32 _ethSignedMessageHash, bytes memory _signature) public pure returns (address) {
        (bytes32 r, bytes32 s, uint8 v) = splitSignature(_signature);
        return ecrecover(_ethSignedMessageHash, v, r, s);
    }
    
    function splitSignature(bytes memory sig) public pure returns (bytes32 r, bytes32 s, uint8 v) {
        require(sig.length == 65, "invalid signature length");
        assembly {
            r := mload(add(sig, 32))
            s := mload(add(sig, 64))
            v := byte(0, mload(add(sig, 96)))
        }
    }
}
```

**ë¹„ìœ :** ì´ ì½”ë“œëŠ” **"ë¹„ë°€ í¸ì§€ì™€ ë´‰ì¸ í™•ì¸"**ì…ë‹ˆë‹¤. ì˜›ë‚  ì™•ì´ ë³´ë‚¸ ë°€ì„œê°€ ì§„ì§œì¸ì§€ í™•ì¸í•˜ëŠ” ê³¼ì •ê³¼ ê°™ìŠµë‹ˆë‹¤.

- **1ë‹¨ê³„: í¸ì§€ ë‚´ìš© í™•ì¸ (`messageHash`)**
  - "ê³µê²©í•˜ë¼!"ë¼ëŠ” í¸ì§€(`_message`)ë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤. ì´ ë‚´ìš©ì„ ë¯¹ì„œê¸°(`keccak256`)ì— ê°ˆì•„ì„œ **í¸ì§€ì˜ ì§€ë¬¸**ì„ ëœ¹ë‹ˆë‹¤.

- **2ë‹¨ê³„: ì™•ì‹¤ ë´‰ì¸ í™•ì¸ (`getEthSignedMessageHash`)**
  - ì´ í¸ì§€ê°€ ì§„ì§œ ì™•ì´ ë³´ë‚¸ ê²ƒì´ë¼ë©´, í¸ì§€ ì•ì— **"ì´ë”ë¦¬ì›€ ì™•êµ­(Ethereum Signed Message)"**ì´ë¼ëŠ” ê³µì‹ ë¬¸êµ¬ê°€ ë¶™ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
  - ì´ ë¬¸êµ¬ê¹Œì§€ í•©ì³ì„œ ë‹¤ì‹œ í•œë²ˆ ì§€ë¬¸ì„ ëœ¹ë‹ˆë‹¤. ì´ê²ƒì´ **ìµœì¢… ë´‰ì¸(í•´ì‹œê°’)**ì…ë‹ˆë‹¤.

- **3ë‹¨ê³„: ì„œëª…ì í™•ì¸ (`recoverSigner`)**
  - í¸ì§€ ë´‰íˆ¬ì— ë¶™ì–´ ìˆëŠ” **ì„œëª…(Signature)**ì„ ë–¼ì–´ë‚´ì„œ íŠ¹ìˆ˜ ê¸°ê³„(`ecrecover`)ì— ë„£ìŠµë‹ˆë‹¤.
  - ê¸°ê³„ëŠ” ì„œëª…ì„ ë¶„ì„í•´ì„œ **"ì´ ì„œëª…ì„ í•œ ì‚¬ëŒì€ 0x1234... ì£¼ì†Œë¥¼ ê°€ì§„ ì‚¬ëŒì…ë‹ˆë‹¤"**ë¼ê³  ì•Œë ¤ì¤ë‹ˆë‹¤.
  - **ë¹„êµ:** ê¸°ê³„ê°€ ì•Œë ¤ì¤€ ì‚¬ëŒ(`recoverSigner` ê²°ê³¼)ì´ ì§„ì§œ ì™•(`_signer`)ê³¼ ë˜‘ê°™ì€ ì‚¬ëŒì´ë©´ **"ì§„ì§œ(true)"**, ì•„ë‹ˆë©´ **"ê°€ì§œ(false)"**ë¼ê³  íŒë³„í•©ë‹ˆë‹¤.

### ìš”ì•½

- **ê¶Œí•œ:** ê¸´ ë¬¸ìì—´("ADMIN_ROLE") ëŒ€ì‹  ì§§ê³  ê³ ìœ í•œ `bytes32` IDë¡œ ë°”ê¿”ì„œ ê´€ë¦¬ (ë¹„ìš© ì ˆê°)
- **ID ìƒì„±:** ì—¬ëŸ¬ ë°ì´í„°ë¥¼ ì„ì–´ì„œ ì ˆëŒ€ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ë²ˆí˜¸í‘œ ìƒì„±
- **ë³´ì•ˆ:** ì„œëª… ìœ„ì¡°ë¥¼ ë§‰ê¸° ìœ„í•´ ì›ë³¸ ë°ì´í„°ì˜ 'ì§€ë¬¸'ì„ ë– ì„œ ê²€ì¦

---

## ğŸ” ì„œëª… ê²€ì¦ì˜ ì›ë¦¬: recoverSignerì™€ keccak256ì˜ ì°¨ì´

`recoverSigner`ì™€ `keccak256`ì€ ë‘˜ ë‹¤ ì•”í˜¸í•™ì„ ì“°ì§€ë§Œ, ê·¸ ì„±ì§ˆì€ ì •ë°˜ëŒ€ì…ë‹ˆë‹¤.

### ê²°ë¡ 

1. **recoverSigner(ì„œëª… ë³µêµ¬)ëŠ” one-wayì™€ ë¬´ê´€í•©ë‹ˆë‹¤.** ì˜¤íˆë ¤ ê·¸ ë°˜ëŒ€ë¡œ, ì„œëª…ì„ í†µí•´ **ê³µê°œí‚¤(Public Key)ë¥¼ ì—­ì‚°(ë³µêµ¬)**í•´ë‚´ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.
2. **ì›ë¦¬:** íƒ€ì›ê³¡ì„  ì•”í˜¸í•™(ECDSA)ì˜ ìˆ˜í•™ì  íŠ¹ì„±ì„ ì´ìš©í•˜ì—¬, ì„œëª…ê°’(v, r, s)ê³¼ ì›ë³¸ ë©”ì‹œì§€ë¡œë¶€í„° **"ì´ ì„œëª…ì„ ë§Œë“¤ ìˆ˜ ìˆëŠ” ìœ ì¼í•œ ê³µê°œí‚¤"**ë¥¼ ê³„ì‚°í•´ëƒ…ë‹ˆë‹¤.

### 1. One-wayì™€ ë¬´ê´€í•œ ì´ìœ  (ë¹„ìœ )

- **Keccak256 (One-way):** ë¯¹ì„œê¸°ì— ì‚¬ê³¼ë¥¼ ë„£ê³  ê°ˆì•„ë²„ë¦° ì£¼ìŠ¤ì…ë‹ˆë‹¤. ì£¼ìŠ¤ë§Œ ë³´ê³  ì‚¬ê³¼ ëª¨ì–‘ì„ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
- **RecoverSigner (ë³µêµ¬ ê°€ëŠ¥):** ì´ê²ƒì€ **"ë„ì¥ ê°ì‹"**ê³¼ ê°™ìŠµë‹ˆë‹¤.
  - ë¬¸ì„œ(ë©”ì‹œì§€)ì— ì°íŒ ë„ì¥(ì„œëª…)ì„ í˜„ë¯¸ê²½ìœ¼ë¡œ ìì„¸íˆ ë“¤ì—¬ë‹¤ë³´ë©´, **"ì´ ë„ì¥ì€ ì² ìˆ˜ì˜ ë„ì¥ì´ë‹¤"**ë¼ëŠ” ì‚¬ì‹¤ì„ ì•Œì•„ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - ì¦‰, ë„ì¥ì„ í›¼ì†(í•´ì‹œ)í•œ ê²Œ ì•„ë‹ˆë¼, ë„ì¥ì˜ ë¬´ëŠ¬(ìˆ˜í•™ì  íŒ¨í„´)ë¥¼ ë¶„ì„í•´ì„œ ì£¼ì¸ì„ ì°¾ì•„ë‚´ëŠ” ê²ƒì…ë‹ˆë‹¤.

### 2. recoverSignerì˜ ì‘ë™ ì›ë¦¬ (ì´ˆë“±í•™ìƒ ë¹„ìœ )

ê¸°ê³„ê°€ ì–´ë–»ê²Œ "ì§„ì§œ ì™•"ì„ ì•Œì•„ë³´ëŠ”ì§€ ë‹¨ê³„ë³„ë¡œ ì„¤ëª…í•´ ë“œë¦´ê²Œìš”.

#### ì¤€ë¹„ë¬¼

- **ì™•ì˜ ë¹„ë°€ ë„ì¥ (ê°œì¸í‚¤):** ì™•ë§Œ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì ˆëŒ€ ê³µê°œ ì•ˆ í•¨.
- **ì™•ì˜ ê³µê°œëœ ì¸ì¥ (ê³µê°œí‚¤/ì£¼ì†Œ):** ì„±ë²½ì— ë¶™ì–´ ìˆì–´ì„œ ëˆ„êµ¬ë‚˜ ì••ë‹ˆë‹¤. (ì˜ˆ: `0xKing...`)
- **í¸ì§€ (ë©”ì‹œì§€):** "ê³µê²©í•˜ë¼"
- **ì„œëª… (v, r, s):** ì™•ì´ ë¹„ë°€ ë„ì¥ìœ¼ë¡œ í¸ì§€ì— ì°ì€ ìêµ­ì…ë‹ˆë‹¤.

#### ê¸°ê³„(recoverSigner)ì˜ ë¶„ì„ ê³¼ì •

ì´ ê¸°ê³„ëŠ” ìˆ˜í•™ ê³µì‹ì„ ì‚¬ìš©í•˜ëŠ” **ì—­ì¶”ì  íƒì •**ì…ë‹ˆë‹¤.

1. **ë‹¨ì„œ ìˆ˜ì§‘:** íƒì •ì—ê²Œ "í¸ì§€ ë‚´ìš©"ê³¼ "ì°íŒ ë„ì¥ ìêµ­(ì„œëª…)"ì„ ì¤ë‹ˆë‹¤.
2. **ìˆ˜í•™ì  ì—­ì¶”ì  (ECDSA):**
   - ë„ì¥ ìêµ­(ì„œëª…)ì€ ì™•ì˜ ë¹„ë°€ ë„ì¥(ê°œì¸í‚¤)ê³¼ í¸ì§€ ë‚´ìš©ì´ ìˆ˜í•™ì ìœ¼ë¡œ ê²°í•©ëœ ê²°ê³¼ë¬¼ì…ë‹ˆë‹¤.
   - íƒì •ì€ ì´ ìêµ­ì˜ ê³¡ì„  ëª¨ì–‘ê³¼ ê°ë„ë¥¼ ë¶„ì„í•´ì„œ ìˆ˜í•™ ê³µì‹ì„ ê±°ê¾¸ë¡œ í’‰ë‹ˆë‹¤.
   - **ê³µì‹:** `ê³µê°œí‚¤ = (ì„œëª…ê°’ s * ëœë¤í¬ì¸íŠ¸ X - ë©”ì‹œì§€í•´ì‹œ * ê¸°ì¤€ì  G) / ì„œëª…ê°’ r`
3. **ë²”ì¸ ì§€ëª© (ì£¼ì†Œ ë³µêµ¬):**
   - ê³„ì‚°ì„ ëë‚¸ íƒì •ì´ ì™¸ì¹©ë‹ˆë‹¤. **"ì´ëŸ° ëª¨ì–‘ì˜ ë„ì¥ ìêµ­ì„ ë‚¨ê¸¸ ìˆ˜ ìˆëŠ” ë„ì¥ì€ ì„¸ìƒì— ë”± í•˜ë‚˜, ë°”ë¡œ `0xKing...`ì˜ ë„ì¥ë¿ì…ë‹ˆë‹¤!"**
4. **ìµœì¢… í™•ì¸:**
   - íƒì •ì´ ì°¾ì•„ë‚¸ ì£¼ì†Œ(`0xKing...`)ê°€ ìš°ë¦¬ê°€ ì•Œê³  ìˆëŠ” ì§„ì§œ ì™•ì˜ ì£¼ì†Œì™€ **ë˜‘ê°™ë‹¤ë©´**, ì´ í¸ì§€ëŠ” ì§„ì§œ ì™•ì´ ì“´ ê²Œ ë§ìŠµë‹ˆë‹¤.
   - ë‹¤ë¥´ë‹¤ë©´ ëˆ„êµ°ê°€ ìœ„ì¡°í•œ ê²ƒì…ë‹ˆë‹¤.

### 3. ëˆ„êµ¬ë‚˜ ê²€ì¦ ê°€ëŠ¥í•˜ì§€ë§Œ ìœ„ì¡°ëŠ” ë¶ˆê°€ëŠ¥

ì„œëª… ê²€ì¦(`recoverSigner`/`ecrecover`)ì€ "ì™•ì˜ í¸ì§€(ì„œëª…)ê°€ ì§„ì§œì¸ì§€"ë¥¼ **ëˆ„êµ¬ë‚˜** ê³µê°œ ì •ë³´ë§Œìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆê²Œ ì„¤ê³„ëœ ë°©ì‹ì…ë‹ˆë‹¤.

#### ì™œ ëˆ„êµ¬ë‚˜ ê²€ì¦í•  ìˆ˜ ìˆë‚˜

- ê²€ì¦ì— í•„ìš”í•œ ê²ƒì€ (1) ë©”ì‹œì§€(ë˜ëŠ” ë©”ì‹œì§€ í•´ì‹œ), (2) ì„œëª…ê°’(v, r, s), (3) ì„œëª…ì ì£¼ì†Œ(ì™• ì£¼ì†Œ)ì²˜ëŸ¼ **ê³µê°œ ê°€ëŠ¥í•œ ì •ë³´**ë¿ì…ë‹ˆë‹¤.
- `ecrecover`ëŠ” ì„œëª…ê³¼ ë©”ì‹œì§€ í•´ì‹œë¡œë¶€í„° "ì´ ì„œëª…ì„ ë§Œë“  ê³µê°œí‚¤(=ì£¼ì†Œ)ê°€ ëˆ„êµ¬ì¸ì§€"ë¥¼ ë³µêµ¬í•´ ì£¼ê³ , ê·¸ ê²°ê³¼ë¥¼ ì™•ì˜ ì£¼ì†Œì™€ ë¹„êµí•´ì„œ ì°¸/ê±°ì§“ì„ íŒë‹¨í•©ë‹ˆë‹¤.

#### ê·¸ë˜ë„ ìœ„ì¡°ê°€ ì–´ë ¤ìš´ ì´ìœ 

- ê³µê²©ìëŠ” ì™•ì˜ **ê°œì¸í‚¤ ì—†ì´** ì™•ê³¼ ê°™ì€ ì„œëª…ì„ ë§Œë“¤ì–´ë‚¼ ìˆ˜ ì—†ê³ , ê²€ì¦ ê³¼ì •ì—ì„œ ë³µêµ¬ëœ ì£¼ì†Œê°€ ì™• ì£¼ì†Œì™€ ì¼ì¹˜í•˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤.

### ìš”ì•½

- `keccak256`ì€ ë°ì´í„°ë¥¼ **íŒŒê´´(ë‹¨ë°©í–¥)**í•´ì„œ ì§€ë¬¸ì„ ë§Œë“œëŠ” ê²ƒì´ê³ ,
- `recoverSigner`ëŠ” ì„œëª…ì— ë‚¨ì•„ìˆëŠ” ìˆ˜í•™ì  í”ì ì„ **ì—­ì¶”ì (ë³µêµ¬)**í•´ì„œ ë„ì¥ ì£¼ì¸ì„ ì°¾ì•„ë‚´ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.
